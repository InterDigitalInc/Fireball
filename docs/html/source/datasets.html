<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Datasets &mdash; Fireball 1.5.1 Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Model" href="model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Fireball 1.5.1
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Fireball</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="playgrounds.html">Playgrounds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Fireball Layers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="layers.html"><em>layersInfo</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html#layer-specifications">Layer Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html#netmarks">Netmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html#blocks">Blocks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basedset">BaseDSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.mnist">MNIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.cifar">CIFAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.imagenet">ImageNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.coco">COCO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.squad">SQuAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.glue">GLUE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fireball.datasets.radioml">RadioML</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fireball 1.5.1</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Datasets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/datasets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="datasets">
<h1>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline"></a></h1>
<section id="basedset">
<h2>BaseDSet<a class="headerlink" href="#basedset" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.base.</span></span><span class="sig-name descname"><span class="pre">BaseDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet" title="Permalink to this definition"></a></dt>
<dd><p>The base class for all other Dataset classes defined in this folder. This class can be used as the base class for both classification and regression problems.</p>
<p>Please refer to the mnist.py for an example of how to derive from this class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a BaseDSet class. Never called directly. It is always called from constructor of a derived class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. Common names include “Train”, “Test”, and “Valid”. Some derived classes may include additional application-specific names.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>samples</strong> (<em>list</em><em>, </em><em>numpy array</em><em>, or </em><em>None</em>) – <ul>
<li><p>If specified it is used as the samples for the dataset. Depending on the application it can be a list or a numpy array.</p></li>
<li><p>If samples is not specified, the loadSamples() method is called. This method MUST be implemented by any derived class.</p></li>
</ul>
</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>numpy array</em><em>, or </em><em>None</em>) – If specified it will be used as the labels for the dataset. Depending on the application it can be a list or a numpy array.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em><em>, </em><em>optional</em>) – If numWorkers is more than zero, “numWorkers” worker threads are created to process and prepare future batches in parallel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evalMetricBiggerIsBetter">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">evalMetricBiggerIsBetter</span></span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evalMetricBiggerIsBetter" title="Permalink to this definition"></a></dt>
<dd><p>Returns True for the evaluation metric of this dataset, a larger value is better. The default implementation in this base class returns True for metrics <strong>mAP</strong>, <strong>Accuracy</strong>, and <strong>PSNR</strong> and False for other metrics.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.isTraining">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">isTraining</span></span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.isTraining" title="Permalink to this definition"></a></dt>
<dd><p>Returns True if this dataset instance is a training dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.getLabelAt">
<span class="sig-name descname"><span class="pre">getLabelAt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.getLabelAt" title="Permalink to this definition"></a></dt>
<dd><p>A method to return the label for the sample specified by the <cite>idx</cite>. This function should be implemented by the derived classes if they have a special way of accessing labels. For an example see the implementation of this method in the <cite>ImageNetDSet</cite> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – The index specifying the sample in the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The label for the specified sample. For classification problems this is usually an integer specifying the class the sample belongs to. For regression problem this may be a single floating point value or a numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int, float, or numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.loadSamples">
<span class="sig-name descname"><span class="pre">loadSamples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.loadSamples" title="Permalink to this definition"></a></dt>
<dd><p>This method loads the dataset information from the dataset files. For the base class, this is just a place holder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method MUST be implemented by the derived classes.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printInfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates Train, Test, and/or Validation datasets. For the base class, this is just a place holder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method MUST be implemented by the derived classes.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.postMakeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">postMakeDatasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.postMakeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method is called at the end of a call to makeDatasets. This can be used by derived classes to setup the dataset class after the datasets are created.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeatable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.split" title="Permalink to this definition"></a></dt>
<dd><p>This method must be implemented by the derived classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.getSplitIndexes">
<span class="sig-name descname"><span class="pre">getSplitIndexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeatable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.getSplitIndexes" title="Permalink to this definition"></a></dt>
<dd><p>This function returns a list of sample indexes that can be used to split this dataset. This is a utility function usually used by the <cite>split</cite> function implemented by the derived classes. As an example, refer the implementation of the <cite>split</cite> function in the <cite>MnistDSet</cite> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – The ratio of the number of split indexes to the total number of samples in this dataset. Default is 10 percent of the sample.</p></li>
<li><p><strong>repeatable</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, the sampling from the original dataset is deterministic and therefore the experiments are repeatable. Otherwise, the sampling is done randomly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of indexes of the samples included in the split.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.mergeWith">
<span class="sig-name descname"><span class="pre">mergeWith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otherDSet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.mergeWith" title="Permalink to this definition"></a></dt>
<dd><p>This function merges the contents of this dataset with the contents of another dataset specified by <cite>otherDSet</cite>. The datasets must have similar properties. The dataset <cite>otherDSet</cite> remains unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>otherDSet</strong> (any object derived from <cite>BaseDSet</cite>) – The contents of this dataset is merged with “self”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.printDsInfo">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printDsInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.printDsInfo" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints information about given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The test dataset.</p></li>
<li><p><strong>validDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The validation dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.printStats">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.printStats" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints statistics of classes for the given set of datasets in a single table. This is used only for the classification datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The test dataset.</p></li>
<li><p><strong>validDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The validation dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.boostClass">
<span class="sig-name descname"><span class="pre">boostClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classIndex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.boostClass" title="Permalink to this definition"></a></dt>
<dd><p>This method increases the number of samples for the specified class by the specified ratio. For example if the ratio is 2, the dataset will have twice the original number of sample for the specified class.</p>
<p>This can be used to add bias for a specific class for training. It is recommended to call this function just before calling the train function of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classIndex</strong> (<em>int</em>) – A index of class. Must be in “range(self.numClasses)”</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio of the new number of samples for the specified class to the original number of samples for that class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter. This is a generic implementation that works for most cases. A derived class may implement a customized version of this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples and labels from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>samples</strong> (<em>list or numpy array</em>) – The batch samples specified by the <cite>batchIndexes</cite>.</p></li>
<li><p><strong>labels</strong> (<em>list or numpy array</em>) – The batch labels specified by the <cite>batchIndexes</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.batches">
<span class="sig-name descname"><span class="pre">batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterBatchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleIndexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.batches" title="Permalink to this definition"></a></dt>
<dd><p>This generator function is used to loop through all the samples. This is used by the <cite>train</cite> method of a <cite>Model</cite> object during the training. This can also be used when evaluating a model using validation or test datasets.</p>
<p>If current dataset is a training or fine-tuning dataset, the samples are shuffled before the start of the loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterBatchSize</strong> (<em>int</em><em>, </em><em>optional</em>) – If not specified the default batch size specified in the <cite>__init__</cite> is used. Otherwise this value overrides the predefine batchSize.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If not specified (=None, default) the dataset’s numWorkers is used. If numWorkers is more than zero, “numWorkers” worker threads are created to process and prepare future batches in parallel.</p></li>
<li><p><strong>sampleIndexes</strong> (<em>list of int</em><em>, </em><em>optional</em>) – if specified the batches are taken only from the samples specified by “sampleIndexes”. Otherwise (default), all available samples are considered for the batches.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>samples</strong> (<em>numpy array</em>) – The next batch of samples.</p></li>
<li><p><strong>labels</strong> (<em>list of 2-tuples or a 3-tuple of numpy arrays</em>) – The next batch of labels.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This function first obtains a list of indexes for the next batch of the dataset. If the number of workers is 0, it calls the <cite>getBatch</cite> function to return the batch samples and labels.</p></li>
<li><p>If number of workers is not zero, the batch indexes are put in the <cite>jobs</cite> Queue which are then used by one of the worker threads.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evaluateModel">
<span class="sig-name descname"><span class="pre">evaluateModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnMetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evaluateModel" title="Permalink to this definition"></a></dt>
<dd><p>This function evaluates the specified model using this dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Fireball Model object</em>) – The model being evaluated.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for the evaluation process. This function processes one batch of the samples at a time. If this is None, the batch size specified for this dataset object in the __init__ function is used instead.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If true, no messages are printed to the “stdout” during the evaluation process.</p></li>
<li><p><strong>returnMetric</strong> (<em>Boolean</em>) – <p>If true, instead of calculating all the results, just calculates the main metric of the dataset and returns that. This is mostly used during the training at the end of each epoch.</p>
<p>Otherwise, if this is False (the default), the full results are calculated and a dictionary of all results is returned.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – <p>This contains some additional task specific arguments. Here is
a list of what can be included in this dictionary.</p>
<blockquote>
<div><ul>
<li><p><strong>maxSamples (int)</strong>: The max number of samples from this dataSet to be processed for the evaluation of the model. If not specified, all samples are used (default behavior).</p></li>
<li><p><strong>sampleIndexes (list of ints)</strong>: A list of sample indexes from this dataset to be processed for the evaluation of the model. If not specified, all samples are used. (default behavior).</p></li>
<li><p><strong>topK (int)</strong>: For classification cases, this indicates whether a “top-K” accuracy value should also be calculated. For example for ImageNet dataset classification, usually the top-5 accuracy value is used (topK=5) besides the top-1. If it is zero (default), the top-K error is not calculated. This is ignored for regression cases.</p></li>
<li><p><strong>confMat (Boolean)</strong>: For classification cases, this indicates whether the confusion matrix should be calculated. If the number of classes is more than 10, this argument is ignored and confusion matrix is not calculated. This is ignored for regression cases.</p></li>
<li><p><strong>expAcc (Boolean or None)</strong>: Ignored for regression cases. For classification cases:</p>
<blockquote>
<div><ul class="simple">
<li><p>If this is a True, the expected accuracy and kappa values are also calculated. When the number of classes and/or number of evaluation samples is large, calculating expected accuracy can take a long time.</p></li>
<li><p>If this is False, the expected accuracy and kappa are not calculated.</p></li>
<li><p>If this is None (the default), then the expected accuracy and kappa are calculated only if number of classes does not exceed 10.</p></li>
</ul>
<p><strong>Note</strong>: If confMat is True, then expAcc is automatically set to True.</p>
</div></blockquote>
</li>
<li><p><strong>jsonFile (str)</strong>: The name of JSON file that is created by this function. This is used with some NLP applications where the results could be saved to a JSON file for evaluation.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>If returnMetric is True, the actual value of dataset’s main metric is returned.</em></p></li>
<li><p><em>Otherwise, this function returns a dictionary containing the results of the evaluation process.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evalMultiDimRegression">
<span class="sig-name descname"><span class="pre">evalMultiDimRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnMetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evalMultiDimRegression" title="Permalink to this definition"></a></dt>
<dd><p>This function evaluates the specified model using this dataset. This is currently only used for multi-dimensional regression problems if the output layer supports evaluation in the graph. (supportsEval is true)</p>
<p>The list of parameters and Return values for this function is the same as the “evaluateModel” function defined above.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.getMetricVal">
<span class="sig-name descname"><span class="pre">getMetricVal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.getMetricVal" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates and returns the evaluation metric specified by “evalMetricName” property of this dataset class. It is called by the <a class="reference internal" href="#fireball.datasets.base.BaseDSet.evaluateModel" title="fireball.datasets.base.BaseDSet.evaluateModel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluateModel()</span></code></a> function when the “returnMetric” argument is set to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> (<em>array</em>) – The predicted values of the output for the evaluation samples. This is a 1-D arrays of labels for Classification problems or an array of output tensors for Regression problems.</p></li>
<li><p><strong>actual</strong> (<em>array</em>) – The actual values of the output for the evaluation samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated value of the metric value for this dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confMat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expAcc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Returns information about evaluation results based on the “predicted” and “actual” values. It calls the “evaluateClassification” function for classification problems and “evaluateRegression” function for regression problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> (<em>array</em>) – The predicted values of the output for the evaluation samples. For classification cases, if topK is not zero, this is a list of arrays each containing the K class indexes with highest probabilities in ascending order (The last one is the best) If topK is zero, then this is a 1-D arrays of predicted labels. For regression cases, this is a list of predicted tensors.</p></li>
<li><p><strong>actual</strong> (<em>array</em>) – The actual values of the output for the evaluation samples.</p></li>
<li><p><strong>topK</strong> (<em>int</em>) – For classification cases, this indicates whether a “top-K” accuracy value should also be calculated. For example for ImageNet dataset classification, usually the top-5 accuracy value is used (topK=5) besides the top-1. If it is zero (default), the top-K error is not calculated. This is ignored for regression cases.</p></li>
<li><p><strong>confMat</strong> (<em>Boolean</em>) – For classification cases, this indicates whether the confusion matrix should be calculated. If the number of classes is more than 10, this argument is ignored and confusion matrix is not calculated. This is ignored for regression cases.</p></li>
<li><p><strong>expAcc</strong> (<em>Boolean</em><em> or </em><em>None</em>) – <p>Ignored for regression cases. For classification cases:</p>
<ul>
<li><p>If this is a True, the expected accuracy and kappa values are also calculated. When the number of classes and/or number of evaluation samples is large, calculating expected accuracy can take a long time.</p></li>
<li><p>If this is False, the expected accuracy and kappa are not calculated.</p></li>
<li><p>If this is None (the default), then the expected accuracy and kappa are calculated only if number of classes does not exceed 10.</p></li>
</ul>
<p><strong>Note</strong>: If confMat is True, then expAcc is automatically set to True.</p>
</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If False, it prints the test results. The printed information includes the Confusion matrix and accuracy information for Classification problems and MSE, RMS, MAE, and PSNR for Regression problems.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of the results information. See “evaluateClassification” and “evaluateRegression” functions for more information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evaluateRegression">
<span class="sig-name descname"><span class="pre">evaluateRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evaluateRegression" title="Permalink to this definition"></a></dt>
<dd><p>Returns information about test results for Regression problems based on the “predicted” and “actual” values.</p>
<p>This function is used only when the regression output of the model is a scaler value. For multi-dimensional regression problems the “evalMultiDimRegression” function is used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is not usually called directly. You should use the “evaluate” function which calls this function internally if this is a regression dataset.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> (<em>array</em>) – The predicted values of the output as an arrays of output tensors.</p></li>
<li><p><strong>actual</strong> (<em>array</em>) – The actual values of the output for the test samples.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If False, it prints the test results. The printed information includes MSE, RMS, MAE, and PSNR.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary of the results information. Here is a list of items in the results dictionary:</p>
<ul class="simple">
<li><p><strong>mse</strong>: Mean Square Error (MSE)</p></li>
<li><p><strong>rmse</strong>: Root Mean Square Error (RMSE)</p></li>
<li><p><strong>mae</strong>: Mean Absolute Error (MAE)</p></li>
<li><p><strong>psnr</strong>: Peak Signal to Noise Ratio (PSNR)</p></li>
<li><p><strong>csvItems</strong>: A list of evaluation metrics that will be included in the CSV file when performing a parameter search.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.evaluateClassification">
<span class="sig-name descname"><span class="pre">evaluateClassification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confMat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expAcc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.evaluateClassification" title="Permalink to this definition"></a></dt>
<dd><p>Returns classification metrics and draws a confusion matrix for the results based on the information in the actual and predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> (<em>array</em>) – The predicted values of the output for the evaluation samples. If topK is not zero, this is a list of arrays each containing the K class indexes with highest probabilities in ascending order (the last one is the best). If topK is zero, then this is a 1-D arrays of predicted labels.</p></li>
<li><p><strong>actual</strong> (<em>array</em>) – The actual values of the output for the test samples.</p></li>
<li><p><strong>topK</strong> (<em>int</em>) – This indicates whether a “top-K” accuracy value should also be calculated. For example for ImageNet dataset classification, usually the top-5 accuracy value is used (topK=5) besides the top-1. If it is zero (default), the top-K error is not calculated.</p></li>
<li><p><strong>confMat</strong> (<em>Boolean</em>) – This indicates whether the confusion matrix should be calculated.
If the number of classes is more than 10, this argument is ignored
and confusion matrix is not calculated.</p></li>
<li><p><strong>expAcc</strong> (<em>Boolean</em><em> or </em><em>None</em>) – <ul>
<li><p>If this is a True, the expected accuracy and kappa values are also calculated. When the number of classes and/or number of evaluation samples is large, calculating expected accuracy can take a long time.</p></li>
<li><p>If this is False, the expected accuracy and kappa are not calculated.</p></li>
<li><p>If this is None (the default), then the expected accuracy and kappa are calculated only if number of classes does not exceed 10.</p></li>
</ul>
<p><strong>Note</strong>: If confMat is True, then expAcc is automatically set to True.</p>
</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If False, it prints the test results. The printed information includes the accuracy information and the Confusion matrix if number of classes is less than 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary of the results information. Here is a list of items in the results dictionary:</p>
<ul>
<li><p><strong>accuracy</strong>: The evaluated accuracy. A float number between 0 and 1. AKA “Observed Accuracy”, it is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[Observed Accuracy = \frac{TN+TP}{N}\]</div>
</div></blockquote>
</li>
<li><p><strong>errorRate</strong>: The evaluated error rate (=1-accuracy). A float number between 0 and 1.</p></li>
<li><p><strong>expectedAccuracy</strong>: Expected Accuracy of the evaluated. It is defined as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ExpectedAccuracy = \frac{(TN+FN)(TN+FP)+(FP+TP)(FN+TP)}{N^2}\]</div>
<ul>
<li><p><strong>kappa</strong>: kappa. It is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\kappa = \frac{Observed Accuracy - Expected Accuracy}{1-Expected Accuracy}\]</div>
</div></blockquote>
</li>
<li><p><strong>truePositives</strong>: An array containing True Positive values (TP) for each class.</p></li>
<li><p><strong>precisions</strong>: An array containing Precision values for each class. The Precision for each class it is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[Precision = \frac{TP}{TP+FP}\]</div>
</div></blockquote>
</li>
<li><p><strong>recalls</strong>: An array containing Recall values for each class. The Recall for each class it is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[Recall = \frac{TP}{TP+FN}\]</div>
</div></blockquote>
</li>
<li><p><strong>fMeasures</strong>: An array containing fMeasures values for each class. The fMeasures for each class it is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[f = \frac{2*Precision*Recall}{Precision+Recall}\]</div>
</div></blockquote>
</li>
<li><p><strong>confusionAP</strong>: A 2-D nxn array where n is the number of classes. confusionAP[a][p] is the number of samples that were predicted in class ‘p’ and are actually in class ‘a’.</p></li>
<li><p><strong>top&lt;N&gt;Accuracy</strong>: Included only if topK is not zero. The &lt;N&gt; in the key name is replaced with the actual value of topK.</p></li>
<li><p><strong>csvItems</strong>: A list of evaluation metrics that will be included in the CSV file when performing a parameter search.</p></li>
</ul>
<p>In the above equations:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>TN</p></td>
<td><p>True Negatives</p></td>
</tr>
<tr class="row-even"><td><p>TP</p></td>
<td><p>True Positives</p></td>
</tr>
<tr class="row-odd"><td><p>FN</p></td>
<td><p>False Negatives</p></td>
</tr>
<tr class="row-even"><td><p>FP</p></td>
<td><p>False Positives</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.base.BaseDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folderName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destDataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.base.BaseDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download dataset files from their original source or a
Fireball online repository. This method is usually called internally by one of the
derived classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folderName</strong> (<em>str</em>) – A string containing the name of the dataset folder. This is used both for Fireball
repository and the destination folder name on local machine.</p></li>
<li><p><strong>files</strong> (<em>list of str</em>) – <p>A list of strings. Each item in the list can be a file name or a URL.</p>
<blockquote>
<div><ul>
<li><p>URL: In this case the URL is tried first (which is usually the original location of the dataset files). If for any reason the file cannot be downloaded then the file name is extracted from the URL and it is downloaded from the Fireball repository.</p></li>
<li><p>Name: In this case the file is downloaded directly from the Fireball repository.</p></li>
</ul>
</div></blockquote>
<p>If the downloaded file is a zip file, it is extracted to the dataset directory.</p>
</p></li>
<li><p><strong>destDataFolder</strong> (<em>str</em>) – The folder where dataset folders and files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.mnist">
<span id="mnist"></span><h2>MNIST<a class="headerlink" href="#module-fireball.datasets.mnist" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference external" href="http://yann.lecun.com/exdb/mnist/">MNIST</a> dataset for handwritten digit Classification.
Use the <code class="docutils literal notranslate"><span class="pre">MnistDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> directory to run the Unit Test of this implementation.</p>
<dl>
<dt><strong>Dataset Stats</strong></dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 33%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Total Samples</p></th>
<th class="head"><p>Samples Per Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Training</p></td>
<td><p>60000</p></td>
<td><p>5421 to 6742</p></td>
</tr>
<tr class="row-odd"><td><p>Test</p></td>
<td><p>10000</p></td>
<td><p>892 to 1135</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.mnist.</span></span><span class="sig-name descname"><span class="pre">MnistDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the MNIST dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs an <cite>MnistDSet</cite> instance. This can be called directly or via <cite>makeDatasets</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one of “Train”, “Test”, or “Tune”. Note that “Valid” cannot be used here.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – <p>The path to the directory where the dataset files are located. This implementation expects the following files in the “dataPath” directory:</p>
<ul>
<li><p>t10k-images.idx3-ubyte</p></li>
<li><p>t10k-labels.idx1-ubyte</p></li>
<li><p>train-images.idx3-ubyte</p></li>
<li><p>train-labels.idx1-ubyte</p></li>
</ul>
</p></li>
<li><p><strong>samples</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is used as the samples for the dataset. It is a numpy array of samples. Each sample is an image represented as a numpy array of shape (28,28,1).</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is a numpy array of int32 values. Each label is an int32 number between 0 and 9 indicating the class for each sample.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the MNIST dataset files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeatable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet.split" title="Permalink to this definition"></a></dt>
<dd><p>This function splits the current dataset and returns a portion of data as a new <cite>MnistDSet</cite> object. The current object is then updated to keep the remaining samples.</p>
<p>This method keeps the same ratio between the number of samples for each class. This means if the original dataset was not balanced, the split datasets also are not balanced and they have the same ratio of number of samples per class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the new dataset that is created.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples that are removed from this dataset to the total number of the samples in this dataset before the split. The default value of 0.1 results in creating a new dataset with %10 of the samples. The remaining %90 of the samples stay in the current instance.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em><em> or </em><em>None</em>) – The batchSize used for the new <cite>MnistDSet</cite> object created. If not specified the new <cite>MnistDSet</cite> instance inherits the batchSize from this object.</p></li>
<li><p><strong>repeatable</strong> (<em>Boolean</em>) – If True, the sampling from the original dataset is deterministic and therefore the experiments are repeatable. Otherwise, the sampling is done randomly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new dataset containing a portion (specified by <cite>ratio</cite>) of samples from this object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fireball.datasets.mnist.MnistDSet" title="fireball.datasets.mnist.MnistDSet">MnistDSet</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet.createFineTuneDataset">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">createFineTuneDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet.createFineTuneDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates a fine-tuning dataset and saves the information permanently on file system so that it can be loaded later.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples in the fine-tuning dataset and total training samples. The default value of 0.1 results in creating a new dataset with %10 of the training samples.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method can be used when consistent results is required. The same dataset samples are used every time the fine-tuning algorithm uses the dataset created by this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.mnist.MnistDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.mnist.MnistDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets as specified by <cite>dsNames</cite> parameter in one-shot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset.</p></li>
<li><p><strong>”Test”</strong>:  Create the test dataset.</p></li>
<li><p><strong>”Valid”</strong>: Create the validation dataset. The ratio of validation samples can be specified using a % sign followed by the percentage. For example “Valid%10” means create a validation dataset with %10 of the training datas.</p>
<blockquote>
<div><p>If “Valid” is included in <cite>dsNames</cite>, there must be at least a “Train” or “Tune” dataset.</p>
<p>If “Tune” is included instead of “Train”, then the validation samples are taken from the fine-tuning samples. (See the examples below.)</p>
</div></blockquote>
</li>
<li><p><strong>”Tune”</strong>:  Create the Fine-Tuning datas. The ratio of fine-tuning samples can be specified using a % sign followed by the percentage. For example “Tune%5” means create a fine-tuning dataset with %5 of the training datas.</p>
<blockquote>
<div><p>If a percentage is not specified and a Tuning dataset file (created by <cite>createFineTuneDataset</cite> function) is available, the fine-tuning samples are loaded from the existing file.</p>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns between one and three <cite>MnistDSet</cite> objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 <cite>MnistDSet</cite> objects</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To specify the training dataset, any string containing the word “train” (case insensitive) is accepted. So, “Training”, “TRAIN”, and ‘train’ all can be used.</p></li>
<li><p>To specify the test dataset, any string containing the word “test” (case insensitive) is accepted. So, “testing”, “TEST”, and ‘test’ all can be used.</p></li>
<li><p>To specify the validation dataset, any string containing the word “valid” (case insensitive) is accepted. So, “Validation”, “VALID”, and ‘valid’ all can be used.</p></li>
<li><p>To specify the fine-tuning dataset, any string containing the word “tun” (case insensitive) is accepted. So, “Fine-Tuning”, “Tuning”, and ‘tune’ all can be used.</p></li>
</ul>
<p>When the ‘%’ is used to specify the ratio for ‘Validation’ and ‘Tuning’ datasets, the subsampling is deterministic and the results are repeatable across different executions and even different platforms. If you want the results to be random, you can use ‘%r’ instead of ‘%’. For example “Tune%r10” creates a dataset with %10 of training data which are selected randomly. A different call on the same or different machine will probably choose a different set of samples.</p>
</div>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test,Valid%5&quot;</span></code>: 3 <cite>MnistDSet</cite> objects are returned for training, test, and validation in the same order. The validation dataset contains %5 of available training data and training dataset contains the remaining %95.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test&quot;</span></code>: 2 <cite>MnistDSet</cite> objects are returned for training and test. The training dataset contains all available training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;FineTuning%r5,Test&quot;</span></code>: 2 <cite>MnistDSet</cite> objects are returned for fine-tuning and test. The fine-tuning dataset contains %5 of the training data (picked randomly because of ‘%r’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Tune%5,Test,Validation%5&quot;</span></code>: 3 <cite>MnistDSet</cite> objects are returned for fine-tuning, test, and validation in the same order. The fine-tuning and validation together contain %5 of available training data. Validation dataset contains %5 of that (0.0025 of training data or %5 of %5) and Fine-Tuning dataset contains the remaining %95 (0.0475 of training data or %95 of %5)</p></li>
</ul>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.cifar">
<span id="cifar"></span><h2>CIFAR<a class="headerlink" href="#module-fireball.datasets.cifar" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of “CifarDSet” dataset class for image Classification (<a class="reference external" href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-100</a>). Use the <code class="docutils literal notranslate"><span class="pre">CifarDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> folder to run the Unit Test of this implementation.</p>
<p>This implementation assumes that the following files exist in the ‘dataPath’ directory:</p>
<ul class="simple">
<li><p>meta: Class Names.</p></li>
<li><p>train: Training Samples and Labels.</p></li>
<li><p>test: Test Samples and Labels.</p></li>
</ul>
<dl>
<dt><strong>Dataset Stats</strong></dt><dd><p>The 100 classes in the CIFAR-100 dataset are grouped into 20 superclasses. In the following table and in the API, “Fine” is used for the case where the 100-class version is used and “Coarse” is use where the 20 superclasses are used.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 27%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Total Samples</p></th>
<th class="head"><p>Samples Per Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Training</p></td>
<td><p>50000</p></td>
<td><p>500 (Fine), 2500 (Coarse)</p></td>
</tr>
<tr class="row-odd"><td><p>Test</p></td>
<td><p>10000</p></td>
<td><p>100 (Fine), 500 (Coarse)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.cifar.</span></span><span class="sig-name descname"><span class="pre">CifarDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarseLabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the CIFAR-100 dataset.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.numClasses">
<span class="sig-name descname"><span class="pre">numClasses</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.numClasses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarseLabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a CifarDSet instance. This can be called directly or via <cite>makeDatasets</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one of “Train”, “Test”, or “Tune”. Note that “Valid” cannot be used here.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>samples</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is used as the samples for the dataset. It is a numpy array of samples. Each sample is an image represented as a numpy array of shape (32,32,3).</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is a numpy array of int32 values. Each label is an int32 number between 0 and 99 (0 and 19 for the coarse dataset) indicating the class for each sample.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>coarseLabels</strong> (<em>Boolean</em>) – If True, the coarse dataset is loaded which has only 20 classes of images.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the CIFAR-100 dataset files from a Fireball
online repository.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeatable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.split" title="Permalink to this definition"></a></dt>
<dd><p>This function splits the current dataset and returns a portion of data as a new <cite>CifarDSet</cite> object. The current object is then updated to keep the remaining samples.</p>
<p>This method keeps the same ratio between the number of samples for each class. This means if the original dataset was not balanced, the split datasets also are not balanced and they have the same ratio of number of samples per class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the new dataset that is created.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples that are removed from this dataset to the total number of the samples in this dataset before the split. The default value of 0.1 results in creating a new dataset with %10 of the samples. The remaining %90 of the samples stay in the current instance.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em><em> or </em><em>None</em>) – The batchSize used for the new <cite>CifarDSet</cite> object created. If not specified the new <cite>CifarDSet</cite> instance inherits the batchSize from this object.</p></li>
<li><p><strong>repeatable</strong> (<em>Boolean</em>) – If True, the sampling from the original dataset is deterministic and therefore the experiments are repeatable. Otherwise, the sampling is done randomly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new dataset containing a portion (specified by <cite>ratio</cite>) of samples from this object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fireball.datasets.cifar.CifarDSet" title="fireball.datasets.cifar.CifarDSet">CifarDSet</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.createFineTuneDataset">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">createFineTuneDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarseLabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.createFineTuneDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates a fine-tuning dataset and saves the information permanently on file system so that it can be loaded later.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples in the fine-tuning dataset and total training samples. The default value of 0.1 results in creating a new dataset with %10 of the training samples.</p></li>
<li><p><strong>coarseLabels</strong> (<em>Boolean</em>) – If True, the coarse dataset (with 20 classes) is loaded and used for creation of the Fine-Tuning dataset.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method can be used when consistent results is required. The same dataset samples are used every time the fine-tuning algorithm uses the dataset created by this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.cifar.CifarDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarseLabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.cifar.CifarDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets as specified by <cite>dsNames</cite> parameter in one-shot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset.</p></li>
<li><p><strong>”Test”</strong>:  Create the test dataset.</p></li>
<li><p><strong>”Valid”</strong>: Create the validation dataset. The ratio of validation samples can be specified using a % sign followed by the percentage. For example “Valid%10” means create a validation dataset with %10 of the training datas.</p>
<blockquote>
<div><p>If “Valid” is included in <cite>dsNames</cite>, it must be after the “Train” or “Tune”.</p>
<p>If “Tune” is included instead of “Train”, then the validation samples are taken from the fine-tuning samples. (See the examples below.)</p>
</div></blockquote>
</li>
<li><p><strong>”Tune”</strong>:  Create the Fine-Tuning datas. The ratio of fine-tuning samples can be specified using a % sign followed by the percentage. For example “Tune%5” means create a fine-tuning dataset with %5 of the training datas.</p>
<blockquote>
<div><p>If a percentage is not specified and a Tuning dataset file (created by <cite>createFineTuneDataset</cite> function) is available, the fine-tuning samples are loaded from the existing file.</p>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>coarseLabels</strong> (<em>Boolean</em>) – If True, the coarse datasets are loaded which have only 20 classes of images.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns between one and three <cite>CifarDSet</cite> objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 <cite>CifarDSet</cite> objects</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To specify the training dataset, any string containing the word “train” (case insensitive) is accepted. So, “Training”, “TRAIN”, and ‘train’ all can be used.</p></li>
<li><p>To specify the test dataset, any string containing the word “test” (case insensitive) is accepted. So, “testing”, “TEST”, and ‘test’ all can be used.</p></li>
<li><p>To specify the validation dataset, any string containing the word “valid” (case insensitive) is accepted. So, “Validation”, “VALID”, and ‘valid’ all can be used.</p></li>
<li><p>To specify the fine-tuning dataset, any string containing the word “tun” (case insensitive) is accepted. So, “Fine-Tuning”, “Tuning”, and ‘tune’ all can be used.</p></li>
</ul>
<p>When the ‘%’ is used to specify the ratio for ‘Validation’ and ‘Tuning’ datasets, the subsampling is deterministic and the results are repeatable across different executions and even different platforms. If you want the results to be random, you can use ‘%r’ instead of ‘%’. For example “Tune%r10” creates a dataset with %10 of training data which are selected randomly. A different call on the same or different machine will probably choose a different set of samples.</p>
</div>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test,Valid%5&quot;</span></code>: 3 <cite>CifarDSet</cite> objects are returned for training, test, and validation in the same order. The validation dataset contains %5 of available training data and training dataset contains the remaining %95.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test&quot;</span></code>: 2 <cite>CifarDSet</cite> objects are returned for training and test. The training dataset contains all available training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;FineTuning%r5,Test&quot;</span></code>: 2 <cite>CifarDSet</cite> objects are returned for fine-tuning and test. The fine-tuning dataset contains %5 of the training data (picked randomly because of ‘%r’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Tune%5,Test,Validation%5&quot;</span></code>: 3 <cite>CifarDSet</cite> objects are returned for fine-tuning, test, and validation in the same order. The fine-tuning and validation together contain %5 of available training data. Validation dataset contains %5 of that (0.0025 of training data or %5 of %5) and Fine-Tuning dataset contains the remaining %95 (0.0475 of training data or %95 of %5)</p></li>
</ul>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.imagenet">
<span id="imagenet"></span><h2>ImageNet<a class="headerlink" href="#module-fireball.datasets.imagenet" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference external" href="http://image-net.org/index">ImageNet</a> dataset for Image Recognition. This implementation assumes that the following files exist in the ‘dataPath’ directory:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ILSVRC2012Train224</span></code>: Contains 1000 folders (one per class named by the class id). The training image files in each folder are named like “Image_nnnnnn.JPEG” with nnnnnn starting at 000001.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ILSVRC2012Val224</span></code>: Contains 1000 folders (one per class named by the class id). The validation image files in each folder are named like “Image_nnnnnn.JPEG” with nnnnnn starting at 000001.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TrainDataset.csv</span></code>: Information about each class and number of training samples for each class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ValDataset.csv</span></code>: Information about each class and number of validation samples for each class.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt><strong>Pre-Processing</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Crop256Cafe</span></code>: Resize smaller dim to 256, Crop center 224, BGR output, normalized with mean: [103.939, 116.779, 123.68]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ForceCafe</span></code>: Force resize to 224x224, May Lose Aspect Ratio, BGR output, normalized with mean: [103.939, 116.779, 123.68]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Crop256PyTorch</span></code>: Resize smaller dim to 256, Crop center 224, RGB output, normalized to 0..1, then use mean:[0.485, 0.456, 0.406] and var: [0.229, 0.224, 0.225]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ForcePyTorch</span></code>: Force resize to 224x224, May Lose Aspect Ratio, RGB output, normalized to 0..1, then use mean:[0.485, 0.456, 0.406] and var: [0.229, 0.224, 0.225]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Crop256Tf</span></code>: Resize smaller dim to 256, Crop center 224, RGB output, normalized to -1..1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ForceTf</span></code>: Force resize to 224x224, May Lose Aspect Ratio, RGB output, normalized to -1..1</p></li>
</ul>
</dd>
</dl>
<p>To test this implementation, run the <code class="docutils literal notranslate"><span class="pre">ImageNetDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> directory.</p>
<p>For more info see <a class="reference external" href="https://github.com/keras-team/keras-applications/blob/master/keras_applications/imagenet_utils.py">Keras image utilities</a> and <a class="reference external" href="https://github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/python/keras/_impl/keras/preprocessing/image.py">preprocessing</a> code.</p>
<dl>
<dt><strong>Dataset Stats</strong></dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 27%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Total Samples</p></th>
<th class="head"><p>Samples Per Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Training</p></td>
<td><p>1,281,167</p></td>
<td><p>732 to 1,300</p></td>
</tr>
<tr class="row-odd"><td><p>Test</p></td>
<td><p>50,000</p></td>
<td><p>50</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.imagenet.</span></span><span class="sig-name descname"><span class="pre">ImageNetDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preProcessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Crop256Cafe'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the ImageNet dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preProcessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Crop256Cafe'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs an ImageNetDSet instance. This can be called directly or via <cite>makeDatasets</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one of “Train”, “Test”, or “Tune”. Note that “Valid” cannot be used here.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>samples</strong> (<em>list</em><em> or </em><em>None</em>) – If specified it is used as the samples for the dataset. It is a list of tuples containing information about the samples in the dataset. If samples is not specified, the <cite>loadSamples</cite> method is called by the base class.</p></li>
<li><p><strong>labels</strong> (<em>None</em>) – The labels for each sample in the dataset.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>preProcessing</strong> (<em>str</em>) – The type of preprocessing used when loading the images. Please refer to the “Pre-Processing” section above in this module’s documentation for an explanation for each one of the pre-processing methods.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the images.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the ImageNet dataset files from a Fireball
online repository. Please note that this does not include the training dataset. Only
Tuning and Test datasets are downloaded. All image files have already been resized to
224x224.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.getImage">
<span class="sig-name descname"><span class="pre">getImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.getImage" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy array containing the image information for the image file specified by the <cite>fileName</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fileName</strong> (<em>str</em>) – The name of the image file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The image information as a numpy array. If the <cite>preProcessing</cite> is one of ‘Crop256Cafe’ or ‘ForceCafe’, the returned value is in BGR format; otherwise it is in RGB format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.preProcessImages">
<span class="sig-name descname"><span class="pre">preProcessImages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.preProcessImages" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses the specified <cite>image</cite> based on the method specified by <cite>preProcessing</cite>. Please refer to the “Pre-Processing” section above in this module’s documentation for an explanation for each one of the pre-processing methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>images</strong> (<em>numpy array</em>) – The image(s) to be pre-processed as a numpy array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The processed image(s) as a numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.resizedImg">
<span class="sig-name descname"><span class="pre">resizedImg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.resizedImg" title="Permalink to this definition"></a></dt>
<dd><p>Resizes the specified image using the method specified by <cite>preProcessing</cite>. The resized image is always a 224x224x3 numpy array of type float32.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img</strong> (<em>numpy array</em>) – The image to be resized.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resized image as a numpy array of shape (224,224,3)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.getPreprocessedImage">
<span class="sig-name descname"><span class="pre">getPreprocessedImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imageFileName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.getPreprocessedImage" title="Permalink to this definition"></a></dt>
<dd><p>A utility function that loads an image, resizes and preprocesses it, and returns it as a numpy array of type float32.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imageFileName</strong> (<em>str</em>) – The path to the image file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resized and preprocessed image as a numpy array of shape (224,224,3)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.split" title="Permalink to this definition"></a></dt>
<dd><p>This function splits the current dataset and returns a portion of data as a new <cite>ImageNetDSet</cite> object. This object is then updated to keep the remaining samples.</p>
<p>This method keeps the same ratio between the number of samples for each class. This means that if the original dataset was not balanced, the split datasets also are not balanced and they have the same ratio of number of samples per class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the new dataset that is created.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples that are removed from this dataset to the total number of the samples in this dataset before the split. The default value of .1 results in creating a new dataset with %10 of the samples. %90 of the samples stay in this object.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em><em> or </em><em>None</em>) – The batchSize used for the new <cite>ImageNetDSet</cite> object created. If not specified the new object inherits the batchSize from this object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new dataset containing a portion (specified by <cite>ratio</cite>) of samples from this object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fireball.datasets.imagenet.ImageNetDSet" title="fireball.datasets.imagenet.ImageNetDSet">ImageNetDSet</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>This function assumes that “self.samples” is organized as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>All samples in class 0
All samples in class 1
        ...
All samples in class 999
</pre></div>
</div>
<p>This is the case if <cite>loadSamples</cite> method is used to load the samples.</p>
</li>
<li><p>The sampling from the original dataset is deterministic and therefore the experiments are repeatable.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.createFineTuneDataset">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">createFineTuneDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copyImages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.createFineTuneDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates a fine-tuning dataset and saves the information permanently on file system so that it can be loaded later.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – The ratio between the number of samples in the fine-tuning dataset and total training samples.
The default value of .1 results in creating a new dataset with %10 of the training samples.</p></li>
<li><p><strong>copyImages</strong> (<em>Boolean</em>) – If true, copies the images from the training images directory to the new directory “ILSVRC2012Tune224”. This is useful when access to the whole dataset is not required for fine-tuning after compression. If this is false, then the images are not copied. The new dataset reuses the original images in the training dataset.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method can be used when consistent results is required. The same dataset samples are used every time the fine-tuning algorithm uses the dataset created by this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preProcessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Crop256Cafe'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets as specified by <cite>dsNames</cite> parameter in one-shot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset.</p></li>
<li><p><strong>”Test”</strong>:  Create the test dataset.</p></li>
<li><p><strong>”Valid”</strong>: Create the validation dataset. The ratio of validation samples can be specified using a % sign followed by the percentage. For example “Valid%10” means create a validation dataset with %10 of the training datas.</p>
<blockquote>
<div><p>If “Valid” is included in <cite>dsNames</cite>, it must be after the “Train” or “Tune”.</p>
<p>If “Tune” is included instead of “Train”, then the validation samples are taken from the fine-tuning samples. See the examples below.</p>
</div></blockquote>
</li>
<li><p><strong>”Tune”</strong>: Create the Fine-Tuning datas. The ratio of fine-tuning samples can be specified using a % sign followed by the percentage. For example “Tune%5” means create a fine-tuning dataset with %5 of the training datas.</p>
<blockquote>
<div><p>If a percentage is not specified and a Tuning dataset (created by <cite>createFineTuneDataset</cite> function) is available in the <cite>dataPath</cite> directory, the fine-tuning samples are loaded from the existing Tuning dataset.</p>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>preProcessing</strong> (<em>str</em>) – The type of preprocessing used when loading the images. Please refer to the “Pre-Processing” section above in this module’s documentation for an explanation for each one of the pre-processing methods.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the images.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns between one and three <cite>ImageNetDSet</cite> objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 ImageNetDSet objects</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>To specify the training dataset, any string containing the word “train” (case insensitive) is accepted. So, “Training”, “TRAIN”, and ‘train’ all can be used.</p></li>
<li><p>To specify the test dataset, any string containing the word “test” (case insensitive) is accepted. So, “testing”, “TEST”, and ‘test’ all can be used.</p></li>
<li><p>To specify the validation dataset, any string containing the word “valid” (case insensitive) is accepted. So, “Validation”, “VALID”, and ‘valid’ all can be used.</p></li>
<li><p>To specify the fine-tuning dataset, any string containing the word “tun” (case insensitive) is accepted. So, “Fine-Tuning”, “Tuning”, and ‘tune’ all can be used.</p></li>
</ul>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test,Valid%5&quot;</span></code>: 3 <cite>ImageNetDSet</cite> objects are returned for training, test, and validation in the same order. The validation dataset contains %5 of training data and training dataset contains the remaining %95.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test&quot;</span></code>: 2 <cite>ImageNetDSet</cite> objects are returned for training and test.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;FineTuning%5,Test&quot;</span></code>: 2 <cite>ImageNetDSet</cite> objects are returned for fine-tuning and test. The fine-tuning dataset contains %5 of the training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Tune%5,Test,Validation%5&quot;</span></code>: 3 <cite>ImageNetDSet</cite> objects are returned for fine-tuning, test, and validation in the same order. The fine-tuning and validation together contain %5 of training data. Validation dataset contains %5 of that (0.0025 of training data or %5 of %5) and Fine-Tuning dataset contains the remaining %95 (0.0475 of training data or %95 of %5)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.imagenet.ImageNetDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.imagenet.ImageNetDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples and labels from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>samples</strong> (<em>numpy array</em>) – The batch samples specified by the <cite>batchIndexes</cite>. Each sample is a resize, pre-processed image as a numpy array of shape (224, 224, 3)</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em>) – The batch labels specified by the <cite>batchIndexes</cite>. A numpy array of integer values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.coco">
<span id="coco"></span><h2>COCO<a class="headerlink" href="#module-fireball.datasets.coco" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference external" href="https://cocodataset.org">COCO</a> dataset class for object detection. Use the <code class="docutils literal notranslate"><span class="pre">CocoDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> folder to run the Unit Test of this implementation.</p>
<p>A sample when it is provided in <cite>getBatch</cite> is tuple of the form: (image, classes, boxes). Internally it is kept as a tuple of the form (imageId, classes, boxes, areas, crowdFlags).</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imageId</span></code>: Unique id of the Image. (int32)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image</span></code>: A numpy float32 tensor of shape (h, w, 3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">classes</span></code>: A numpy int32 tensor of shape (n,) where n is the number of objects in the image. Each number is the class index of the object. Class indexes start at ‘1’ and end with ‘80’. Class ‘0’ is reserved for background.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boxes</span></code>: A numpy float32 tensor of shape (n,4) where n is the number of objects in the image. The 4 numbers for each bbox are x1, y1, w, and h. (<code class="docutils literal notranslate"><span class="pre">P1Size</span></code> format)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">areas</span></code>: A numpy float32 tensor of shape (n,) where n is the number of objects in the image. Each number give the area of the object (IMPORTANT NOTE: This is different and usually smaller than the area of the box)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crowdFlags</span></code>: A numpy boolean tensor of shape (n,). Each element indicates whether the object is in a crowd of other overlapping objects.</p></li>
</ul>
</div></blockquote>
<p>A batch of samples is a list of samples as defined above.</p>
<p>This implementation assumes the following files/folders exist in the <cite>dataPath</cite> directory:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">annotations</span></code>: The json files containing annotations (information about images, and objects inside each image)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train2014</span></code>: Training Images (2014)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">val2014</span></code>: Validation Images (2014)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">val2017</span></code>: Validation Images (2017)</p></li>
</ul>
</div></blockquote>
<dl>
<dt><strong>Dataset Stats</strong></dt><dd><table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 13%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" rowspan="2"><p>Dataset</p></th>
<th class="head" rowspan="2"><p>Total</p>
<p>Images</p>
</th>
<th class="head" rowspan="2"><p>Total</p>
<p>Objects</p>
</th>
<th class="head" colspan="2"><p>Crowd</p></th>
<th class="head" rowspan="2"><p>Images with</p>
<p>no Objects</p>
</th>
<th class="head" rowspan="2"><p>Max Objects</p>
<p>Per Image</p>
</th>
</tr>
<tr class="row-even"><th class="head"><p>Objects</p></th>
<th class="head"><p>Images</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>train2014</p></td>
<td><p>82,783</p></td>
<td><p>604,906</p></td>
<td><p>7,038</p></td>
<td><p>6,395</p></td>
<td><p>702</p></td>
<td><p>93</p></td>
</tr>
<tr class="row-even"><td><p>val2014</p></td>
<td><p>40,504</p></td>
<td><p>291,874</p></td>
<td><p>3,460</p></td>
<td><p>3131</p></td>
<td><p>367</p></td>
<td><p>70</p></td>
</tr>
<tr class="row-odd"><td><p>val2017</p></td>
<td><p>5,000</p></td>
<td><p>36,781</p></td>
<td><p>446</p></td>
<td><p>411</p></td>
<td><p>48</p></td>
<td><p>63</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.coco.</span></span><span class="sig-name descname"><span class="pre">CocoDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepAr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the Coco Dataset dataset.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.numClasses">
<span class="sig-name descname"><span class="pre">numClasses</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.numClasses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepAr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs an CocoDSet instance. This can be called directly or via <cite>makeDatasets</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one of “Train”, “Test”, “Valid”.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>resolution</strong> (<em>int</em>) – The resolution of the images. Default is 512 for 512x512 images</p></li>
<li><p><strong>keepAr</strong> (<em>Boolean</em>) – This specifies whether the aspect ratio of the image should be kept when it is resized.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the images.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the COCO dataset files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepAr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets as specified by <cite>dsNames</cite> parameter in one-shot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset. Training dataset uses the images in the “train2014” folder.</p></li>
<li><p><strong>”Test”</strong>:  Create the test dataset. Test dataset uses the images in the “val2017” folder.</p></li>
<li><p><strong>”Valid”</strong>: Create the validation dataset. Validation dataset uses the images in the “val2014” folder.</p></li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>resolution</strong> (<em>int</em>) – The resolution of the images. Default is 512 for 512x512 images</p></li>
<li><p><strong>keepAr</strong> (<em>Boolean</em>) – This specifies whether the aspect ratio of the image should be kept when it is resized.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the images.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns between one and three CocoDSet objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 CocoDSet objects</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To specify the training dataset, any string containing the word “train” (case insensitive) is accepted. So, “Training”, “TRAIN”, and ‘train’ all can be used.</p></li>
<li><p>To specify the test dataset, any string containing the word “test” (case insensitive) is accepted. So, “testing”, “TEST”, and ‘test’ all can be used.</p></li>
<li><p>To specify the validation dataset, any string containing the word “valid” (case insensitive) is accepted. So, “Validation”, “VALID”, and ‘valid’ all can be used.</p></li>
</ul>
</div>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;Train,Test,Valid&quot;</span></code>: 3 <cite>ImageNetDSet</cite> objects are returned for training, test, and validation in the same order.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dsNames=&quot;TRAINING,TEST&quot;</span></code>: 2 <cite>ImageNetDSet</cite> objects are returned for training and test.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.getStats">
<span class="sig-name descname"><span class="pre">getStats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.getStats" title="Permalink to this definition"></a></dt>
<dd><p>Returns some statistics about this instance of CocoDSet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>sampleCounts</strong> (<em>numpy array</em>) – This is 2d numpy array. <code class="docutils literal notranslate"><span class="pre">sampleCounts[c][1]</span></code> is the number of images in the whole dataset that contains an instance of class ‘c’. <code class="docutils literal notranslate"><span class="pre">sampleCounts[c][0]</span></code> is the total number of times instances of class ‘c’ appear in all images in the dataset.</p></li>
<li><p><strong>numCrowd</strong> (<em>list</em>) – This is a list containing 2 integer numbers. <code class="docutils literal notranslate"><span class="pre">numCrowd[0]</span></code> is the total number of times a “Crowd” object appears in the whole dataset. <code class="docutils literal notranslate"><span class="pre">numCrowd[1]</span></code> is the number of images in the dataset that contain at least one “Crowd” object.</p></li>
<li><p><strong>numEmptyImages</strong> (<em>int</em>) – This is the number of images in the dataset that don’t contain any objects in it.</p></li>
<li><p><strong>maxObjectsPerImage</strong> (<em>int</em>) – This is the maximum number of objects that appeared in an image in the whole dataset.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.printStats">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.printStats" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints statistics of classes for the given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (<a class="reference internal" href="#fireball.datasets.coco.CocoDSet" title="fireball.datasets.coco.CocoDSet"><em>CocoDSet</em></a><em>, </em><em>optional</em>) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (<a class="reference internal" href="#fireball.datasets.coco.CocoDSet" title="fireball.datasets.coco.CocoDSet"><em>CocoDSet</em></a><em>, </em><em>optional</em>) – The test dataset.</p></li>
<li><p><strong>validDs</strong> (<a class="reference internal" href="#fireball.datasets.coco.CocoDSet" title="fireball.datasets.coco.CocoDSet"><em>CocoDSet</em></a><em>, </em><em>optional</em>) – The validation dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.getImage">
<span class="sig-name descname"><span class="pre">getImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.getImage" title="Permalink to this definition"></a></dt>
<dd><p>This returns an image in BGR format as a numpy array of type float32 and shape (h,w,3).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img</strong> (<em>numpy array</em><em>, </em><em>int/np.int32</em><em>, or </em><em>str</em>) – <ul class="simple">
<li><p>If this is a numpy array, it is assumed that the image has already been loaded and it is just returned without any modifications.</p></li>
<li><p>If this is an int/np.int32, it is assumed to be the id of the image and it is used to get the image file name and then load the image from the file.</p></li>
<li><p>If this is a str, then it is assumed to be the name of the file and it is used to load the image.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The loaded image is returned in BGR format as a numpy array of type float32 and shape (h,w,3). Where ‘w’ and ‘h’ are equal to the ‘resolution’ argument in the ‘__init__’ or ‘makeDatasets’ functions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.p1P2ToP1Size">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">p1P2ToP1Size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.p1P2ToP1Size" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [x1, y1, x2, y2] to [x1, y1, w, h]</p>
<p>This class method changes all the boxes in the “boxes” array from “P1P2” format to “P1Size” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “P1P2” format. In “P1P2” format each box is represented with array of 4 numbers [x1, y1, x2, y2] where (x1,y1) and (x2,y2) represent the top-left and bottom-right corners of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “P1Size” format. In “P1Size” format each box is represented with array of 4 numbers [x1, y1, w, h] where (x1,y1) and (w,h) represent the top-left corner of the box and size of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.p1SizeToP1P2">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">p1SizeToP1P2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.p1SizeToP1P2" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [x1, y1, w, h] to [x1, y1, x2,y 2]</p>
<p>This class method changes all the boxes in the “boxes” array from “P1Size” format to “P1P2” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “P1Size” format. In “P1Size” format each box is represented with array of 4 numbers [x1, y1, w, h] where (x1,y1) and (w,h) represent the top-left corner of the box and size of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “P1P2” format. In “P1P2” format each box is represented with array of 4 numbers [x1, y1, x2, y2] where (x1,y1) and (x2,y2) represent the top-left and bottom-right corners of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.p1P2ToCenterSize">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">p1P2ToCenterSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.p1P2ToCenterSize" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [x1, y1, x2, y2] to [cx, cy, w, h]</p>
<p>This class method changes all the boxes in the “boxes” array from “P1P2” format to “CenterSize” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “P1P2” format. In “P1P2” format each box is represented with array of 4 numbers [x1, y1, x2, y2] where (x1,y1) and (x2,y2) represent the top-left and bottom-right corners of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “CenterSize” format. In “CenterSize” format each box is represented with array of 4 numbers [cx, cy, w, h] where (cx,cy) and (w,h) represent the center point and size of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.centerSizeToP1P2">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">centerSizeToP1P2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.centerSizeToP1P2" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [cx, cy, w, h] to [x1, y1, x2, y2]</p>
<p>This class method changes all the boxes in the “boxes” array from “CenterSize” format to “P1P2” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “CenterSize” format. In “CenterSize” format each box is represented with array of 4 numbers [cx, cy, w, h] where (cx,cy) and (w,h) represent the center point and size of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “P1P2” format. In “P1P2” format each box is represented with array of 4 numbers [x1, y1, x2, y2] where (x1,y1) and (x2,y2) represent the top-left and bottom-right corners of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.p1SizeToCenterSize">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">p1SizeToCenterSize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.p1SizeToCenterSize" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [x1, y1, w, h] to [cx, cy, w, h]</p>
<p>This class method changes all the boxes in the “boxes” array from “P1Size” format to “CenterSize” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “P1Size” format. In “P1Size” format each box is represented with array of 4 numbers [x1, y1, w, h] where (x1,y1) and (w,h) represent the top-left corner and size of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “CenterSize” format. In “CenterSize” format each box is represented with array of 4 numbers [cx, cy, w, h] where (cx,cy) and (w,h) represent the center point and size of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.centerSizeToP1Size">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">centerSizeToP1Size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.centerSizeToP1Size" title="Permalink to this definition"></a></dt>
<dd><p>Convert from [cx, cy, w, h] to [x1, y1, w, h]</p>
<p>This class method changes all the boxes in the “boxes” array from “CenterSize” format to “P1Size” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> (<em>1-D</em><em> or </em><em>2D list</em><em> or </em><em>numpy array of ints</em><em> or </em><em>floats</em>) – This contains one or more boxes in “CenterSize” format. In “CenterSize” format each box is represented with array of 4 numbers [cx, cy, w, h] where (cx,cy) and (w,h) represent the center point and size of the box correspondingly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The box(s) in the “P1P2” format. In “P1Size” format each box is represented with array of 4 numbers [x1, y1, w, h] where (x1,y1) and (w,h) represent the top-left corner of the box and size of the box correspondingly.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same shape and type of the input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.scaleImageAndBoxes">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">scaleImageAndBoxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepAr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P1Size'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.scaleImageAndBoxes" title="Permalink to this definition"></a></dt>
<dd><p>This class method scales the specified image to a square <cite>res x res</cite> image. If keepAr is true, the aspect ratio is kept by padding the smaller dimension with zeros (black). It then scales all boxes specified in the <cite>boxes</cite> using the same ratio used to scale the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy array</em>) – The image as a numpy array of shape (h,w,3)</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>None</em>) – A set of bounding boxes for the objects present in the image. The boxes are stored using the format specified by <cite>boxFormat</cite>. It can be <cite>None</cite> or empty which indicates there are no boxes to be scaled.</p></li>
<li><p><strong>res</strong> (<em>int</em>) – The target resolution to scale to. The returned value is a square <cite>res x res</cite> image.</p></li>
<li><p><strong>keepAr</strong> (<em>Boolean</em>) – This specifies whether the aspect ratio of the image should be kept when it is scaled.</p></li>
<li><p><strong>boxFormat</strong> (<em>str</em>) – This specifies the format of the <cite>boxes</cite>. See the box formats in the Notes section below.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>resizedImg</strong> (<em>numpy array</em>) – The scaled image as a numpy array of shape (res,res,3)</p></li>
<li><p><strong>modifiedBoxes</strong> (<em>numpy array or None</em>) – The scaled boxes as a numpy array (Same shape and type as <cite>boxes</cite>) or <cite>None</cite> if <cite>boxes</cite> is None.</p></li>
<li><p><strong>imgSize</strong> (<em>tuple</em>) – The size of original image as a 2-tuple (w,h).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>boxFormat</cite> specifies the format of the boxes. It can be one of the following:</p>
<ul class="simple">
<li><p><strong>P1Size</strong>: The boxes are [x1, y1, w, h] with (x1,y1) and (w,h) as top-left corner and size of the box correspondingly.</p></li>
<li><p><strong>CenterSize</strong>: The boxes are [cx, cy, w, h] with (cx,cy) and (w,h) as center point and size of the box correspondingly.</p></li>
<li><p><strong>P1P2</strong>: The boxes are [x1, y1, x2, y2] with (x1,y1) and (x2,y2) as top-left and bottom-right corners of the boxes correspondingly.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.flipImageHorizontally">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">flipImageHorizontally</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P1Size'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.flipImageHorizontally" title="Permalink to this definition"></a></dt>
<dd><p>This class method flips an image horizontally. It then moves all the boxes specified in the <cite>boxes</cite> so that they bound the original objects in the flipped images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy array</em>) – The image as a numpy array of shape (h,w,3)</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>None</em>) – A set of bounding boxes for the objects present in the image. The boxes are stored using the format specified by <cite>boxFormat</cite>. It can be <cite>None</cite> or empty which indicates there are no boxes to be flipped.</p></li>
<li><p><strong>boxFormat</strong> (<em>str</em>) – This specifies the format of the <cite>boxes</cite>. See the box formats in the Notes section below.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>flippedImg</strong> (<em>numpy array</em>) – The flipped image as a numpy array of shape (res,res,3)</p></li>
<li><p><strong>flippedBoxes</strong> (<em>numpy array or None</em>) – The flipped boxes as a numpy array (Same shape and type as <cite>boxes</cite>) or <cite>None</cite> if <cite>boxes</cite> is None.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>boxFormat</cite> specifies the format of the boxes. It can be one of the following:</p>
<ul class="simple">
<li><p><strong>P1Size</strong>: The boxes are [x1, y1, w, h] with (x1,y1) and (w,h) as top-left corner and size of the box correspondingly.</p></li>
<li><p><strong>CenterSize</strong>: The boxes are [cx, cy, w, h] with (cx,cy) and (w,h) as center point and size of the box correspondingly.</p></li>
<li><p><strong>P1P2</strong>: The boxes are [x1, y1, x2, y2] with (x1,y1) and (x2,y2) as top-left and bottom-right corners of the boxes correspondingly.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.zoomOutAndMove">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">zoomOutAndMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newRes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P1Size'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.zoomOutAndMove" title="Permalink to this definition"></a></dt>
<dd><p>This class method scales the image down and then move the smaller image by an offset specified by <cite>offset</cite>. The return value is a black <cite>res x res</cite> image that contains a <cite>newRes x newRes</cite> image at a location that is specified by <cite>offset</cite> (from the center of the image).</p>
<p>It then scales and moves all the boxes specified in the <cite>boxes</cite> so that they bound the original objects in the resized/moved images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy array</em>) – The image as a numpy array of shape (h,w,3)</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>None</em>) – A set of bounding boxes for the objects present in the image. The boxes are stored using the format specified by <cite>boxFormat</cite>. It can be <cite>None</cite> or empty which indicates there are no boxes to be scaled/moved.</p></li>
<li><p><strong>newRes</strong> (<em>int</em>) – The new resolution of the image. The returned image contains a <cite>newRes x newRes</cite> image.</p></li>
<li><p><strong>res</strong> (<em>int</em>) – The resolution of the returned image.</p></li>
<li><p><strong>offset</strong> (<em>tuple</em>) – This 2-tuple specifies the offset of the scaled image from the center point of the image.</p></li>
<li><p><strong>boxFormat</strong> (<em>str</em>) – This specifies the format of the <cite>boxes</cite>. See the box formats in the Notes section below.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>movedImg</strong> (<em>numpy array</em>) – The scaled/moved image as a numpy array of shape (res,res,3)</p></li>
<li><p><strong>movedBoxes</strong> (<em>numpy array or None</em>) – The scaled/moved boxes as a numpy array (Same shape and type as <cite>boxes</cite>) or <cite>None</cite> if <cite>boxes</cite> is None.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>boxFormat</cite> specifies the format of the boxes. It can be one of the following:</p>
<ul class="simple">
<li><p><strong>P1Size</strong>: The boxes are [x1, y1, w, h] with (x1,y1) and (w,h) as top-left corner and size of the box correspondingly.</p></li>
<li><p><strong>CenterSize</strong>: The boxes are [cx, cy, w, h] with (cx,cy) and (w,h) as center point and size of the box correspondingly.</p></li>
<li><p><strong>P1P2</strong>: The boxes are [x1, y1, x2, y2] with (x1,y1) and (x2,y2) as top-left and bottom-right corners of the boxes correspondingly.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.setAcnchorBoxes">
<span class="sig-name descname"><span class="pre">setAcnchorBoxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchorBoxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.setAcnchorBoxes" title="Permalink to this definition"></a></dt>
<dd><p>Sets the anchor boxes for this dataset. The anchor boxes are created by an SSD model and passed to this class so that they can be used during training and evaluation of the models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>anchorBoxes</strong> (<em>numpy array</em>) – An nx4 numpy array, where n is the number of anchor boxes. The boxes are in “CenterSize” format [cx, cy, w, h] with all values normalized to an image size of <cite>1.0 x 1.0</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.getGroundTruth">
<span class="sig-name descname"><span class="pre">getGroundTruth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.getGroundTruth" title="Permalink to this definition"></a></dt>
<dd><p>This function receives lists of objects and their locations on an image and creates the ground-truth information used for training a model. The ground-truth information includes the label and location information for each one of the anchor boxes defined by the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>numpy array</em>) – This 1-D array contains the class of each object in an image.</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em>) – This 2-D matrix contains the box information for each object in an image. The boxes are in “P1Size” format. The number of boxes in this array should match the number of labels in the <cite>labels</cite> parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gtLabels</strong> (<em>numpy array</em>) – The label for each anchor box. The number of items in the array is equal to the number of anchor boxes defined by the model. (See setAcnchorBoxes)</p></li>
<li><p><strong>gtBoxAdj</strong> (<em>numpy array</em>) – This the adjustment applied to each anchor box to match it to one of the ground-truth boxes in the image. Shape: (numAnchors, 4)</p></li>
<li><p><strong>gtMask</strong> (<em>numpy array</em>) – A Foreground/background indicator for each anchor box: 1-&gt;Foreground, -1-&gt;Background, 0-&gt;Neutral</p></li>
<li><p><strong>gtIous</strong> (<em>numpy array</em>) – This is a 1-D array of IOU values for each anchor box. For the i’th anchor box, this function finds the box in the <cite>boxes</cite> array that has the highest IOU with the anchor box. It then sets gtIous[i] to this maximum value.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.showImageAndBoxes">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">showImageAndBoxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.showImageAndBoxes" title="Permalink to this definition"></a></dt>
<dd><p>This class method shows the specified image and the bounding boxes in a matplotlib.pyplot diagram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy array</em>) – The image as a numpy array of shape (height, width, 3) in BGR format.</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>list</em>) – Each item in <cite>boxes</cite> represents a single box in “P1Size” format [x,y,w,h].</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em><em> or </em><em>list</em>) – The class of each object in the image. This is used to look up the class name and show it as caption for the object on the image. Th number of labels should match the number of boxes.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title used for the displayed image.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function blocks current thread until the user closes the image window manually.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.showSample">
<span class="sig-name descname"><span class="pre">showSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampleIndex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleId</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.showSample" title="Permalink to this definition"></a></dt>
<dd><p>This function shows one of the samples in this dataset as specified by the <cite>sampleIndex</cite>
or <cite>sampleId</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampleIndex</strong> (<em>int</em><em> or </em><em>None</em>) – The sample index. This index is used to get the specified sample in the dataset.</p></li>
<li><p><strong>sampleId</strong> (<em>int</em><em> or </em><em>None</em>) – The sample identifier. This is used to find the sample index. The sample index can then be used get the specified sample in the dataset.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title used for the displayed image.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <cite>sampleIndex</cite> is specified <cite>sampleId</cite> is ignored, otherwise <cite>sampleId</cite> must be specified.</p></li>
<li><p>This function blocks current thread until the user closes the image window manually.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.showInferResults">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">showInferResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arKept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.showInferResults" title="Permalink to this definition"></a></dt>
<dd><p>This function shows the results of inference. First the <cite>image</cite> is sent to the model to detect all the objects in the image. The detected information include bounding boxes, the labels, and scores (or confidence factors) for each detected object. The information is then passed to this function to display the image together with the detected objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy array</em>) – The image as a numpy array of shape (height, width, 3) in BGR format.</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>list</em>) – The detected boxes in P1Size format with normalized (between 0 and 1) coordinates. The number of labels, scores, and boxes, should match.</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em><em> or </em><em>list</em>) – The class of each detected object in the image. This is used to look up the class name and show it as caption for each detected object in the image. The number of labels, scores, and boxes, should match.</p></li>
<li><p><strong>scores</strong> (<em>numpy array</em><em> or </em><em>list</em>) – The score (or confidence) for each detected object in the image. The number of labels, scores, and boxes, should match.</p></li>
<li><p><strong>arKept</strong> (<em>Boolean</em>) – If True, it means the aspect ratio of the image was kept when it was fed to the model for inference.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title used for the displayed image.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function blocks current thread until the user closes the image window manually.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.randomMutate">
<span class="sig-name descname"><span class="pre">randomMutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.randomMutate" title="Permalink to this definition"></a></dt>
<dd><p>This function randomly mutates the specified image. It can be used for data augmentation to improve the training of the model.</p>
<p>Currently 2 types of mutations are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p>Horizontal Flip (%25 probability)</p></li>
<li><p>Zoom out and move (%25 probability)</p></li>
</ul>
</div></blockquote>
<p>Also %50 of the time the original image is returned without any modifications. Please refer to <cite>flipImageHorizontally</cite> and <cite>zoomOutAndMove</cite> functions for more detail about these mutations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>numpy array</em>) – The image as a numpy array of shape (height, width, 3) in BGR format.</p></li>
<li><p><strong>boxes</strong> (<em>numpy array</em><em> or </em><em>list</em>) – Each item in <cite>boxes</cite> represents a single box in “P1Size” format [x,y,w,h].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mutatedImg</strong> (<em>numpy array</em>) – The modified image as a numpy array (same shape and format as the original image)</p></li>
<li><p><strong>mutatedBoxes</strong> (<em>numpy array</em>) – The modified boxes as a numpy array (Same shape and type as <cite>boxes</cite>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter.</p>
<p>If the anchor boxes are already given to this dataset (See <cite>setAcnchorBoxes</cite>) then it is assumed we are training a model. In this case this function provides the pre-processed image together with ground-truth information (see <cite>getGroundTruth</cite>).</p>
<p>For the training case, you can enable data augmentation using the <cite>augment</cite> property. By default this is set to False.</p>
<p>If the anchor boxes are not available, it is assumed we are in inference mode. In this case the pre-processed images are returned together with a list of tuples (imageId, imageSize).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>images</strong> (<em>numpy array</em>) – The batch images specified by the <cite>batchIndexes</cite>. Each image is resized, pre-processed, and possibly mutated and returned as a numpy array.</p></li>
<li><p><strong>labels</strong> (<em>list of 2-tuples or a 3-tuple of numpy arrays</em>) –</p>
<ul>
<li><p>If training, a 3-tuple is used as “labels” for the batch. The tuple contains the following items:</p>
<blockquote>
<div><ul class="simple">
<li><p>Ground-truth labels</p></li>
<li><p>Ground-truth box adjustments</p></li>
<li><p>Ground-truth background masks</p></li>
</ul>
</div></blockquote>
</li>
<li><p>If inferring, a list of tuples (imageId, imageSize).</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isTraining</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>This function returns the results of inference and evaluates the results. It then returns the result statistics together with a human readable text string containing details of evaluation results in the form of a table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<em>list of tuples</em>) – <p>The results is a list of tuples [ (IMG0, DT0), (IMG1, DT1), … ] where:</p>
<ul>
<li><p>IMGi : The i’th image id.</p></li>
<li><p>DTi : The predicted information for the i’th image. It is a 3-tuple containing numpy arrays: ([CLASS0, CLASS1, …], [BOX0, BOX1, …], [SCORE0, SCORE1, …])</p>
<blockquote>
<div><ul class="simple">
<li><p>CLASSj : The class index (between 1 and numClasses - 0/background should not appear here).</p></li>
<li><p>BOXj : The predicted bounding box for the j’th object detected in the i’th image in P1P2 format.</p></li>
<li><p>SCOREj : The score (or confidence) for the j’th detected object.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>The classes, boxes, and scores are sorted based on the descending order of scores. (The best predictions appear first)</p>
</p></li>
<li><p><strong>isTraining</strong> (<em>Boolean</em>) – True means this function is called during the training (at the end of each epoch) to show the intermediate results during the training. In this case the results are calculated only for a single combination of area/maxDet.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If true, this function shows the progress during the calculations and prints the details of results in the form of a table. Otherwise, this function does not print anything during the process.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ap50</strong> (<em>numpy array</em>) – A numpy array containing the average precision for all combinations of area/maxDet calculated with IOU threshold of .50.</p></li>
<li><p><strong>ap75</strong> (<em>numpy array</em>) – A numpy array containing the average precision for all combinations of area/maxDet calculated with IOU threshold of .75.</p></li>
<li><p><strong>ap</strong> (<em>numpy array</em>) – A numpy array containing the average precision for all combinations of area/maxDet averaged over IOU threshold values 0.50, 0.55, … 0.95.</p></li>
<li><p><strong>ar</strong> (<em>numpy array</em>) – A numpy array containing the average recall for all combinations of area/maxDet averaged over IOU threshold values 0.50, 0.55, … 0.95.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.coco.CocoDSet.evaluateModel">
<span class="sig-name descname"><span class="pre">evaluateModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnMetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.coco.CocoDSet.evaluateModel" title="Permalink to this definition"></a></dt>
<dd><p>This function evaluates the specified model using this dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Fireball Model object</em>) – The model being evaluated.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for the evaluation process. This function processes one batch of the samples at a time. If this is None, the batch size specified for this dataset object in the __init__ function is used instead.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If true, no messages are printed to the “stdout” during the evaluation process.</p></li>
<li><p><strong>returnMetric</strong> (<em>Boolean</em>) – <p>If true, instead of calculating all the results, just calculates the main metric of the dataset and returns that. This is mostly used during the training at the end of each epoch.</p>
<p>Otherwise, if this is False (the default), the full results are calculated and a dictionary of all results is returned.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – <p>This contains some additional task specific arguments. Here is
a list of what can be included in this dictionary.</p>
<blockquote>
<div><ul>
<li><p><strong>maxSamples (int)</strong>: The max number of samples from this dataSet to be processed for the evaluation of the model. If not specified, all samples are used (default behavior).</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>If returnMetric is True, the actual value of dataset’s main metric (mAP) is returned.</em></p></li>
<li><p><em>Otherwise, this function returns a dictionary containing the results of the evaluation process.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.squad">
<span id="squad"></span><h2>SQuAD<a class="headerlink" href="#module-fireball.datasets.squad" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference external" href="https://rajpurkar.github.io/SQuAD-explorer/">SQuAD</a> dataset class for NLP Question-Answering tasks.
Use the <code class="docutils literal notranslate"><span class="pre">SquadDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> folder to run the Unit Test of this implementation.</p>
<p>This implementation assumes that the following files exist in the ‘dataPath’ directory:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">train-v1.1.json</span></code>: The training dataset for SQuAD version 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dev-v1.1.json</span></code>: The evaluation dataset for SQuAD version 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train-v2.0.json</span></code>: The training dataset for SQuAD version 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dev-v2.0.json</span></code>: The evaluation dataset for SQuAD version 2</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>When training, the actual answer text is not used. Only start and end tokens are included in the labels.</p></li>
<li><p>When evaluating, the start and end positions are not used and the answer text is used to compare with the predicted answer.</p></li>
<li><p>If there is a <code class="docutils literal notranslate"><span class="pre">vocab.txt</span></code> file in the ‘dataPath’ directory and no tokenizer is specified, this file is used to create a tokenizer.</p></li>
<li><p>The first time each JSON file is read, the tokenized information is saved in FNJ files. The FNJ files are used every time after that which makes the loading process faster.</p></li>
<li><p>While reading JSON files some of the samples are dropped because one of the following reasons:</p>
<ul>
<li><p>The question length is too short (less than 4 tokens)</p></li>
<li><p>Questions with no answers in SQuAD version 1.</p></li>
<li><p>Answer tokens could not be found in the context. (See the method “shouldDrop”)</p></li>
</ul>
</li>
</ul>
</div>
<p><strong>Dataset Stats</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Version 1:</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 12%" />
<col style="width: 15%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Training</p></th>
<th class="head"><p>Evaluation</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Num Samples</p></td>
<td><p>87844</p></td>
<td><p>10833</p></td>
<td><p>Total number of samples (segmented</p>
<p>contexts counted multiple times).</p>
</td>
</tr>
<tr class="row-odd"><td><p>Num Questions</p></td>
<td><p>87599</p></td>
<td><p>10570</p></td>
<td><p>Total number of questions in the</p>
<p>dataset. (Some questions ignored)</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Questions Kept</p></td>
<td><p>87451</p></td>
<td><p>10570</p></td>
<td><p>Number of questions kept.</p></td>
</tr>
<tr class="row-odd"><td><p>Num Answers</p></td>
<td><p>87844</p></td>
<td><p>35556</p></td>
<td><p>Total Number of answers (Multiple</p>
<p>answers for same question counted</p>
<p>multiple times</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Contexts</p></td>
<td><p>18896</p></td>
<td><p>2067</p></td>
<td><p>Total number of context paragraphs.</p></td>
</tr>
<tr class="row-odd"><td><p>Num Titles</p></td>
<td><p>442</p></td>
<td><p>48</p></td>
<td><p>Total number of subjects (titles)</p></td>
</tr>
<tr class="row-even"><td><p>Max Context Len</p></td>
<td><p>853</p></td>
<td><p>789</p></td>
<td><p>Maximum length of context paragraphs.</p></td>
</tr>
<tr class="row-odd"><td><p>Max Question Len</p></td>
<td><p>61</p></td>
<td><p>38</p></td>
<td><p>Maximum length of questions.</p></td>
</tr>
<tr class="row-even"><td><p>Num Impossible</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>Number of questions with no answer</p></td>
</tr>
<tr class="row-odd"><td><p>Max Num Answers</p></td>
<td><p>1</p></td>
<td><p>6</p></td>
<td><p>Maximum number of answers for a</p>
<p>question.</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Segmented</p></td>
<td><p>893</p></td>
<td><p>183</p></td>
<td><p>Number of times a context paragraph</p>
<p>was segmented because it was too</p>
<p>long. This is based on the following</p>
<p>segmentation params:</p>
<ul class="simple">
<li><p>maxSeqLen = 384</p></li>
<li><p>stride = 128</p></li>
<li><p>maxQuestionLen = 64</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Version 2:</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 12%" />
<col style="width: 15%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Training</p></th>
<th class="head"><p>Evaluation</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Num Samples</p></td>
<td><p>131805</p></td>
<td><p>12232</p></td>
<td><p>Total number of samples (segmented</p>
<p>contexts are counted multiple times).</p>
</td>
</tr>
<tr class="row-odd"><td><p>Num Questions</p></td>
<td><p>130319</p></td>
<td><p>11873</p></td>
<td><p>Total number of questions in the</p>
<p>original dataset. (Some questions are</p>
<p>ignored)</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Questions Kept</p></td>
<td><p>130184</p></td>
<td><p>11873</p></td>
<td><p>Number of questions kept.</p></td>
</tr>
<tr class="row-odd"><td><p>Num Answers</p></td>
<td><p>87074</p></td>
<td><p>20850</p></td>
<td><p>Total Number of answers (Multiple</p>
<p>answers forthe same question counted</p>
<p>multiple times.</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Contexts</p></td>
<td><p>19035</p></td>
<td><p>1204</p></td>
<td><p>Total number of context paragraphs.</p></td>
</tr>
<tr class="row-odd"><td><p>Num Titles</p></td>
<td><p>442</p></td>
<td><p>35</p></td>
<td><p>Total number of subjects (titles)</p></td>
</tr>
<tr class="row-even"><td><p>Max Context Len</p></td>
<td><p>853</p></td>
<td><p>789</p></td>
<td><p>Maximum length of context paragraphs.</p></td>
</tr>
<tr class="row-odd"><td><p>Max Question Len</p></td>
<td><p>61</p></td>
<td><p>38</p></td>
<td><p>Maximum length of questions.</p></td>
</tr>
<tr class="row-even"><td><p>Num Impossible</p></td>
<td><p>44731</p></td>
<td><p>6129</p></td>
<td><p>Number of questions with no answer</p>
<p>(segmented samples are counted</p>
<p>multiple times)</p>
</td>
</tr>
<tr class="row-odd"><td><p>Max Num Answers</p></td>
<td><p>1</p></td>
<td><p>6</p></td>
<td><p>Maximum number of answers for a</p>
<p>question.</p>
</td>
</tr>
<tr class="row-even"><td><p>Num Segmented</p></td>
<td><p>1373</p></td>
<td><p>210</p></td>
<td><p>Number of times a context paragraph</p>
<p>was segmented because it was too long.</p>
<p>This is based on the following</p>
<p>segmentation params:</p>
<ul class="simple">
<li><p>maxSeqLen = 384</p></li>
<li><p>stride = 128</p></li>
<li><p>maxQuestionLen = 64</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.squad.</span></span><span class="sig-name descname"><span class="pre">SquadDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the SQuAD dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a <cite>SquadDSet</cite> instance. This can be called directly or via <cite>makeDatasets</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the dataset. It can be one of “Train” or “Test”.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em><em>, </em><em>optional</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>version</strong> (<em>int</em><em>, </em><em>optional</em>) – The SQuAD version of the dataset. It can be 1 or 2.</p></li>
<li><p><strong>tokenizer</strong> (<em>Tokenizer object</em><em>, </em><em>optional</em>) – The tokenizer used to tokenize the text info in the dataset files.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em><em>, </em><em>optional</em>) – If numWorkers is more than zero, “numWorkers” worker threads are created to process and prepare future batches in parallel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the SQuAD dataset files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets in one-shot as specified by <cite>dsNames</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset.</p></li>
<li><p><strong>”Test”</strong>: Create the test dataset.</p></li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>version</strong> (<em>int</em>) – The version of SQuAD dataset (1 or 2)</p></li>
<li><p><strong>tokenizer</strong> (<em>Tokenizer object</em>) – The tokenizer used by all created datasets. If this is None, and there is a “vocab.txt” file in the “dataPath”, this method tries to create a tokenizer using “vocab.txt” as its vocabulary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns one or two SquadDSet objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 2 SquadDSet objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.printDsInfo">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printDsInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.printDsInfo" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints information about given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (<a class="reference internal" href="#fireball.datasets.squad.SquadDSet" title="fireball.datasets.squad.SquadDSet"><em>SquadDSet</em></a><em>, </em><em>optional</em>) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (<a class="reference internal" href="#fireball.datasets.squad.SquadDSet" title="fireball.datasets.squad.SquadDSet"><em>SquadDSet</em></a><em>, </em><em>optional</em>) – The test dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.printStats">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.printStats" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints dataset statistics for the given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (<a class="reference internal" href="#fireball.datasets.squad.SquadDSet" title="fireball.datasets.squad.SquadDSet"><em>SquadDSet</em></a><em>, </em><em>optional</em>) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (<a class="reference internal" href="#fireball.datasets.squad.SquadDSet" title="fireball.datasets.squad.SquadDSet"><em>SquadDSet</em></a><em>, </em><em>optional</em>) – The test dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples and labels from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>samples</strong> (<em>tuple of 3 items:</em>) –</p>
<ul class="simple">
<li><p>batchTokenIds:    2D list of integer tokenId values for ‘n’ sequences (where ‘n’ is current batch size). Each sequence (row) contains ‘maxSeqLen’ tokens including tokens for the question, the context, and paddings</p></li>
<li><p>batchTokenTypes:  2D list of integers one for each tokenId in “batchTokenIds”. ‘0’ is used for question tokens and ‘1’ for context (or a segment of context). ‘0’ is also used for the padding tokens.</p></li>
</ul>
</li>
<li><p><strong>labels</strong> (<em>tuple of 2 items</em>) – For training mode, the label contains the following lists:</p>
<ul class="simple">
<li><p>batchStartPos: For each sample in the batch, this contains the position of the first token of ground-truth answer.</p></li>
<li><p>batchStartPos: For each sample in the batch, this contains the position of the last token of ground-truth answer.</p></li>
</ul>
<p>For evaluation mode, the label contains the following lists:</p>
<ul class="simple">
<li><p>batchAnswerTexts: For each sample in the batch, this is a list of text strings containing the possible answers to the questions.</p></li>
<li><p>batchTokenInMaxContext: For each sample in the batch, this is a boolean list. Each item in the list indicates whether the corresponding token in the sequence is in its maximum context. This is used when the answer may appear in different segments of the same context. We only should consider the results when the token is in its max context.</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.evaluateModel">
<span class="sig-name descname"><span class="pre">evaluateModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnMetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.evaluateModel" title="Permalink to this definition"></a></dt>
<dd><p>This function evaluates the specified model using this dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Fireball Model object</em>) – The model being evaluated.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for the evaluation process. This function processes one batch of the samples at a time. If this is None, the batch size specified for this dataset object in the __init__ function is used instead.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If true, no messages are printed to the “stdout” during the evaluation process.</p></li>
<li><p><strong>returnMetric</strong> (<em>Boolean</em>) – <p>If true, instead of calculating all the results, just calculates the main metric of the dataset and returns that. This is mostly used during the training at the end of each epoch. The main metric for the SQuAD dataset is the exact match accuracy.</p>
<p>Otherwise, if this is False (the default), the full results are calculated and a dictionary of all results is returned.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – <p>This contains some additional task specific arguments. Here is
a list of what can be included in this dictionary.</p>
<blockquote>
<div><ul>
<li><p><strong>maxSamples (int)</strong>: The max number of samples from this dataSet to be processed for the evaluation of the model. If not specified, all samples are used (default behavior).</p></li>
<li><p><strong>jsonFile (str)</strong>: If specified, this is the name of JSON file that is created by this function.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>If returnMetric is True, the actual value of dataset’s main metric is returned.</em></p></li>
<li><p><em>Otherwise, this function returns a dictionary containing the results of the evaluation process.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.squad.SquadDSet.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noAnswerProbThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.squad.SquadDSet.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Returns information about evaluation results based on the “predicted” values. This function is usually called by the <code class="docutils literal notranslate"><span class="pre">evaluateModel</span></code> function. But it can also be called when we have a the prediction results as a dictionary.</p>
<p>If you want to evaluate the prediction results from a JSON file, the name of JSON file can also be passed in prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>dict</em><em> or </em><em>str</em>) – <ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">predictions</span></code> is a dictionary, it should have the text string for each question Id in this dataset. In other words, the keys are the question IDs in this dataset and the values are the actual answer text string predicted by the model.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">predictions</span></code> is a str, it should be the name of a JSON file containing the prediction results. The JSON file should contain a dictionay with a format as explained above.</p></li>
</ul>
</p></li>
<li><p><strong>noAnswerProbThreshold</strong> (<em>float</em>) – If the predicted probability of not having an answer for a question is more than this value, then we assume that the prediction is no-answer. In this case we consider this an exact match if the <code class="docutils literal notranslate"><span class="pre">impossible</span></code> flag for this question is set in the dataset and a mismatch otherwise.</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If False, it prints the test results. The printed information includes the Confusion matrix and accuracy information for Classification problems and MSE, RMS, MAE, and PSNR for Regression problems.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary of the results information. Here is a list of items in the results dictionary:</p>
<ul class="simple">
<li><p><strong>exact</strong>: The exact match accuracy. A float number between 0 and 1.</p></li>
<li><p><strong>f1</strong>: The F1 value which is calculated based on how similar the predicted and the ground-truth answer texts are.</p></li>
<li><p><strong>numQuestions</strong>: Total number of questions involved in the evaluation</p></li>
<li><p><strong>hasAnsExact</strong>: The exact match accuracy for the questions that actually have an answer (Not impossible)</p></li>
<li><p><strong>hasAnsF1</strong>: The F1 value for the questions that actually have an answer (Not impossible)</p></li>
<li><p><strong>numHasAns</strong>: The number of questions that have an answer (Not Impossible) involved in the evaluation</p></li>
<li><p><strong>noAnsExact</strong>: The exact match accuracy for the impossible questions.</p></li>
<li><p><strong>noAnsF1</strong>: The F1 value for the impossible questions.</p></li>
<li><p><strong>numNoAns</strong>: The number of impossible questions involved in the evaluation</p></li>
<li><p><strong>csvItems</strong>: A list of evaluation metrics that will be included in the CSV file when performing a parameter search.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.glue">
<span id="glue"></span><h2>GLUE<a class="headerlink" href="#module-fireball.datasets.glue" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference external" href="https://gluebenchmark.com">GLUE</a> dataset class for different NLP tasks. Use the <code class="docutils literal notranslate"><span class="pre">GlueDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> folder to run the Unit Test of this implementation.</p>
<p>This implementation assumes that the following folders exist in the ‘dataPath’ directory for each one of supported GLUE tasks. For more information about GLUE tasks please refer to: <a class="reference external" href="https://gluebenchmark.com/tasks">https://gluebenchmark.com/tasks</a></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CoLA</span></code>: The Corpus of Linguistic Acceptability</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SST-2</span></code>: The Stanford Sentiment Treebank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MRPC</span></code>: Microsoft Research Paraphrase Corpus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STS-B</span></code>: Semantic Textual Similarity Benchmark</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QQP</span></code>: Quora Question Pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MNLI</span></code>: MultiNLI (Matched and Mismatched)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QNLI</span></code>: Question NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RTE</span></code>: Recognizing Textual Entailment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WNLI</span></code>: Winograd NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNLI</span></code>: Stanford NLI Corpus (Not officially part of GLUE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AX</span></code>: Auxiliary Task (GLUE Diagnostic Dataset)</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If there is a “vocab.txt” file in the ‘dataPath’ directory and no tokenizer is specified, this file is used to create a tokenizer.</p></li>
<li><p>While reading dataset files some of the samples may be dropped if the sequence length exceeds the ‘maxSeqLen’</p></li>
</ul>
</div>
<p><strong>Tasks</strong></p>
<dl>
<dt>CoLA</dt><dd><p>The Corpus of Linguistic Acceptability (Metric: Matthew’s Corr)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Unacceptable</p>
<p>1 Acceptable</p>
</td>
<td><p>2528   (29.56% )</p>
<p>6023   (70.44%)</p>
</td>
<td><p>322    (30.87%)</p>
<p>721    (69.13%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>8551   (80.24% )</p></td>
<td><p>1043    (9.79%)</p></td>
<td><p>1063    (9.97%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>47</p>
<p>0</p>
</td>
<td><p>35</p>
<p>0</p>
</td>
<td><p>38</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>SST-2</dt><dd><p>The Stanford Sentiment Treebank (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Negative</p>
<p>1 Positive</p>
</td>
<td><p>29780   (44.22%)</p>
<p>37569   (55.78%)</p>
</td>
<td><p>428    (49.08%)</p>
<p>444    (50.92%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>67349   (96.16%)</p></td>
<td><p>872     (1.24%)</p></td>
<td><p>1821    (2.60%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>66</p>
<p>0</p>
</td>
<td><p>55</p>
<p>0</p>
</td>
<td><p>64</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>MRPC</dt><dd><p>Microsoft Research Paraphrase Corpus (Metric: F1/Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Irrelevant</p>
<p>1 Equivalent</p>
</td>
<td><p>1194   (32.55%)</p>
<p>2474   (67.45%)</p>
</td>
<td><p>129    (31.62%)</p>
<p>279    (68.38%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>3668   (63.23%)</p></td>
<td><p>408     (7.03%)</p></td>
<td><p>1725   (29.74%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>103</p>
<p>0</p>
</td>
<td><p>86</p>
<p>0</p>
</td>
<td><p>104</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>STS-B</dt><dd><p>Semantic Textual Similarity Benchmark (Metric: Pearson-Spearman Corr)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Total Count</p>
<p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>5749</p>
<p>125</p>
<p>0</p>
</td>
<td><p>1500</p>
<p>87</p>
<p>0</p>
</td>
<td><p>1379</p>
<p>81</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>QQP</dt><dd><p>Quora Question Pairs (Metric: F1/Accuracy)</p>
<p><strong>NOTE</strong>: This dataset contains some invalid records in train and dev files which are ignored.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Different</p>
<p>1 Duplicate</p>
</td>
<td><p>229471  (63.07%)</p>
<p>134378  (36.93%)</p>
</td>
<td><p>25545   (63.18%)</p>
<p>14885   (36.82%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>363849  (45.75%)</p></td>
<td><p>40430   (5.08%)</p></td>
<td><p>390965  (49.16%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>330</p>
<p>0</p>
</td>
<td><p>199</p>
<p>0</p>
</td>
<td><p>319</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>MNLI-m</dt><dd><p>MultiNLI (Matched) (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Contradiction</p>
<p>1 Entailment</p>
<p>2 Neutral</p>
</td>
<td><p>130903 (33.33%)</p>
<p>130899 (33.33%)</p>
<p>130900 (33.33%)</p>
</td>
<td><p>3213   (32.74%)</p>
<p>3479   (35.45%)</p>
<p>3123   (31.82%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>392702 (95.24%)</p></td>
<td><p>9815    (2.38%)</p></td>
<td><p>9796    (2.38%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>444</p>
<p>0</p>
</td>
<td><p>237</p>
<p>0</p>
</td>
<td><p>249</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>MNLI-mm</dt><dd><p>MultiNLI (Mismatched) (Metric: Accuracy)</p>
<p><strong>NOTE</strong>: This task is only available for ‘dev’ and ‘test’ datasets. It should be used with the model trained for the <code class="docutils literal notranslate"><span class="pre">MNLI-m</span></code> task.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 32%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Contradiction</p>
<p>1 Entailment</p>
<p>2 Neutral</p>
</td>
<td><p>3240   (32.95%)</p>
<p>3463   (35.22%)</p>
<p>3129   (31.82%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>9832   (2.38%)</p></td>
<td><p>9847    (2.39%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>211</p>
<p>0</p>
</td>
<td><p>262</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>QNLI</dt><dd><p>Question NLI (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 NotEntailment</p>
<p>1 Entailment</p>
</td>
<td><p>52366  (50.00%)</p>
<p>52372  (50.00%)</p>
</td>
<td><p>2761   (50.54%)</p>
<p>2702   (49.46%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>104738 (90.55%)</p></td>
<td><p>5463    (4.72%)</p></td>
<td><p>5463    (4.72%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>307</p>
<p>5</p>
</td>
<td><p>250</p>
<p>0</p>
</td>
<td><p>294</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: Using maxSeqLen=384, 5 training samples are dropped because they result in longer sequences.</p>
</dd>
<dt>RTE</dt><dd><p>Recognizing Textual Entailment (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 NotEntailment</p>
<p>1 Entailment</p>
</td>
<td><p>1241   (49.84%)</p>
<p>1249   (50.16%)</p>
</td>
<td><p>131    (47.29%)</p>
<p>146    (52.71%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>2490   (43.18%)</p></td>
<td><p>277     (4.80%)</p></td>
<td><p>3000   (52.02%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>289</p>
<p>0</p>
</td>
<td><p>253</p>
<p>0</p>
</td>
<td><p>252</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>WNLI</dt><dd><p>Winograd NLI (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 NotEntailment</p>
<p>1 Entailment</p>
</td>
<td><p>323    (50.87%)</p>
<p>312    (49.13%)</p>
</td>
<td><p>40     (56.34%)</p>
<p>31     (43.66%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>635    (74.53%)</p></td>
<td><p>71      (8.33%)</p></td>
<td><p>146    (17.14%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>108</p>
<p>0</p>
</td>
<td><p>105</p>
<p>0</p>
</td>
<td><p>100</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>SNLI</dt><dd><p>Stanford NLI Corpus (Not officially part of GLUE) (Metric: Accuracy)</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Training Samples</p></th>
<th class="head"><p>Dev Samples</p></th>
<th class="head"><p>Test Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0 Contradiction</p>
<p>1 Entailment</p>
<p>2 Neutral</p>
</td>
<td><p>183187 (33.35%)</p>
<p>183416 (33.39%)</p>
<p>182764 (33.27%)</p>
</td>
<td><p>3278   (33.31%)</p>
<p>3329   (33.82%)</p>
<p>3235   (32.87%)</p>
</td>
<td><p>Unknown</p>
<p>Unknown</p>
<p>Unknown</p>
</td>
</tr>
<tr class="row-odd"><td><p>Total</p></td>
<td><p>549367 (96.54%)</p></td>
<td><p>9842    (1.73%)</p></td>
<td><p>9824    (1.73%)</p></td>
</tr>
<tr class="row-even"><td><p>Max Seq. len</p>
<p>Samples Dropped</p>
</td>
<td><p>71</p>
<p>0</p>
</td>
<td><p>59</p>
<p>0</p>
</td>
<td><p>36</p>
<p>0</p>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>AX</dt><dd><p>Auxiliary Task (GLUE Diagnostic Dataset)</p>
<p>This task is only available for ‘test’ dataset. It is used when submitting results to GLUE website. The labels should be predicted using the model trained by <code class="docutils literal notranslate"><span class="pre">MNLI-M</span></code> task. The labels for the samples in this dataset are unknown. Here are some statistics:</p>
<blockquote>
<div><ul class="simple">
<li><p>Total Samples:   1104</p></li>
<li><p>Max Seq. len:    121</p></li>
<li><p>Samples Dropped: 0</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.glue.</span></span><span class="sig-name descname"><span class="pre">GlueDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taskName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the GLUE group of datasets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taskName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a <cite>GlueDSet</cite> instance. This can be called directly or via <a class="reference internal" href="#fireball.datasets.glue.GlueDSet.makeDatasets" title="fireball.datasets.glue.GlueDSet.makeDatasets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeDatasets()</span></code></a> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskName</strong> (<em>str</em>) – <dl class="simple">
<dt>One of the GLUE task names. Currently the following tasks are supported:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;CoLA&quot;</span></code>: The Corpus of Linguistic Acceptability</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;SST-2&quot;</span></code>: The Stanford Sentiment Treebank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MRPC&quot;</span></code>: Microsoft Research Paraphrase Corpus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;STS-B&quot;</span></code>: Semantic Textual Similarity Benchmark</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;QQP&quot;</span></code>: Quora Question Pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MNLI-M&quot;</span></code>: MultiNLI Matched</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MNLI-MM&quot;</span></code>: MultiNLI Mismatched</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;QNLI&quot;</span></code>: Question NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RTE&quot;</span></code>: Recognizing Textual Entailment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;WNLI&quot;</span></code>: Winograd NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;SNLI&quot;</span></code>: Stanford NLI Corpus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;AX&quot;</span></code>: Auxiliary Task (GLUE Diagnostic Dataset)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one “Train”, “Dev”, or “Test”.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>tokenizer</strong> (<em>Tokenizer object</em>) – The tokenizer used to tokenize the text info in the dataset files.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the samples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taskName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the GLUE dataset files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskName</strong> (<em>str</em>) – <p>The name of task for which the dataset files will be downloaded. If set to <code class="docutils literal notranslate"><span class="pre">&quot;All&quot;</span></code> the dataset
files for all GLUE tasks will be downloaded. Otherwise it should be one of the following:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;CoLA&quot;</span></code>: The Corpus of Linguistic Acceptability</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;SST-2&quot;</span></code>: The Stanford Sentiment Treebank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MRPC&quot;</span></code>: Microsoft Research Paraphrase Corpus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;STS-B&quot;</span></code>: Semantic Textual Similarity Benchmark</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;QQP&quot;</span></code>: Quora Question Pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MNLI-M&quot;</span></code>: MultiNLI Matched</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MNLI-MM&quot;</span></code>: MultiNLI Mismatched</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;QNLI&quot;</span></code>: Question NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;RTE&quot;</span></code>: Recognizing Textual Entailment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;WNLI&quot;</span></code>: Winograd NLI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;SNLI&quot;</span></code>: Stanford NLI Corpus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;AX&quot;</span></code>: Auxiliary Task (GLUE Diagnostic Dataset)</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taskName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Dev,Test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numWorkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets in one-shot as specified by <cite>dsNames</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskName</strong> (<em>str</em>) – One of the GLUE task names. Please refer to the documentation for the <a class="reference internal" href="#fireball.datasets.glue.GlueDSet.__init__" title="fireball.datasets.glue.GlueDSet.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method above for more details about supported tasks.</p></li>
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Train</span></code>: Create the training dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dev</span></code>:  Create the dev dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Test</span></code>:  Create the test dataset. (Labels unknown)</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>tokenizer</strong> (<em>Tokenizer object</em>) – The tokenizer used by all created datasets. If this is None, and there is a <code class="docutils literal notranslate"><span class="pre">vocab.txt</span></code> file in the <code class="docutils literal notranslate"><span class="pre">dataPath</span></code>, this method tries to create a tokenizer using <code class="docutils literal notranslate"><span class="pre">vocab.txt</span></code> as its vocabulary.</p></li>
<li><p><strong>numWorkers</strong> (<em>int</em>) – The number of worker threads used to load the samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns one to three GlueDSet objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 <a class="reference internal" href="#fireball.datasets.glue.GlueDSet" title="fireball.datasets.glue.GlueDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlueDSet</span></code></a> objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.printDsInfo">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printDsInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">devDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.printDsInfo" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints information about given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The training dataset.</p></li>
<li><p><strong>devDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The dev dataset.</p></li>
<li><p><strong>testDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The test dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.printStats">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">devDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.printStats" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints statistics of the given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The training dataset.</p></li>
<li><p><strong>devDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The dev dataset.</p></li>
<li><p><strong>testDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The test dataset. (Unknown Labels)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples and labels from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>samples</strong> (<em>tuple</em>) –</p>
<p>This is a 4-tuple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="p">(</span><span class="n">batchSampleIdxs</span><span class="p">,</span> <span class="n">batchTokenIds</span><span class="p">,</span> <span class="n">batchTokenTypes</span><span class="p">)</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>batchSampleIdxs</strong>: 1D list of sample indexes for the samples in this batch.</p></li>
<li><p><strong>batchTokenIds</strong>: 2D list of integer tokenId values for ‘n’ sequences (where ‘n’ is current batch size). Each sequence (row) contains ‘maxSeqLen’ tokens including CLS, SEP, and paddings</p></li>
<li><p><strong>batchTokenTypes</strong>: 2D list of integers one for each tokenId in “batchTokenIds”. ‘0’ is used for first text tokens and ‘1’ for the second text tokens. ‘0’ is also used for the padding tokens.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>labels</strong> (<em>numpy array of int32 or float32</em>) – For classification tasks this contains the label for each one of batch samples. For regression tasks, this contains the ground-truth value for each one of the batch samples.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.glue.GlueDSet.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confMat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expAcc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.glue.GlueDSet.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Returns information about evaluation results based on the “predicted” and “actual” values. This is usually called by the <a class="reference internal" href="#fireball.datasets.base.BaseDSet.evaluateModel" title="fireball.datasets.base.BaseDSet.evaluateModel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluateModel()</span></code></a> method which should be called to evaluate a model with this dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> (<em>array</em>) – The predicted values of the output for the test samples. This is a 1-D arrays of labels for Classification tasks or an array of output values for Regression tasks (STS-B).</p></li>
<li><p><strong>actual</strong> (<em>array</em>) – The actual values of the output for the test samples.</p></li>
<li><p><strong>topK</strong> (<em>int</em>) – Not used for this dataset</p></li>
<li><p><strong>confMat</strong> (<em>Boolean</em>) – For classification cases, this indicates whether the confusion matrix should be calculated. If the number of classes is more than 10, this argument is ignored and confusion matrix is not calculated. This is ignored for regression cases.</p></li>
<li><p><strong>expAcc</strong> (<em>Boolean</em><em> or </em><em>None</em>) – <p>Ignored for regression cases. For classification cases:</p>
<ul>
<li><p>If this is a True, the expected accuracy and kappa values are also calculated. When the number of classes and/or number of evaluation samples is large, calculating expected accuracy can take a long time.</p></li>
<li><p>If this is False, the expected accuracy and kappa are not calculated.</p></li>
<li><p>If this is None (the default), then the expected accuracy and kappa are calculated only if number of classes does not exceed 10.</p></li>
</ul>
<p><strong>Note</strong>: If confMat is True, then expAcc is automatically set to True.</p>
</p></li>
<li><p><strong>quiet</strong> (<em>Boolean</em>) – If False, it prints the test results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>For ‘test’ datasets, since the labels are unknown, this function returns a list of tuples like (index, predictedLabel) which can be used to make the ‘tsv’ files for submission to GLUE website. Otherwise, a dictionary of evaluation result values is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples or dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fireball.datasets.radioml">
<span id="radioml"></span><h2>RadioML<a class="headerlink" href="#module-fireball.datasets.radioml" title="Permalink to this headline"></a></h2>
<p>This module contains the implementation of <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet" title="fireball.datasets.radioml.RadioMlDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadioMlDSet</span></code></a> class that encapsulates the <a class="reference external" href="https://www.deepsig.ai/datasets">RadioML</a> dataset for Modulation Classification problem.</p>
<p>The directory structure should be something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
    <span class="n">RadioML</span>
        <span class="n">RML2016_10b</span>
        <span class="n">RML2018_01</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">RadioMlDSetUnitTest.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">UnitTest/Datasets</span></code> folder to run the Unit Test of this implementation.</p>
<p>The dataset contains samples of shape 128x1x2 (1024x1x2 for 2018 version) and labels which indicate one of 10 modulation types (24 for 2018 version). Each sample contains the floating point numbers captured as a time series. The time-series are the samples taken from I and Q signals. The samples were captured at 20 different SNR values (26 for 2018 version).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the 2018 version, you need to download the “RML2018_01” dataset and run the <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.createNpzFiles" title="fireball.datasets.radioml.RadioMlDSet.createNpzFiles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">createNpzFiles()</span></code></a> class method (only once) to extract the numpy files for each SNR value from the original “GOLD_XYZ_OSC.0001_1024.hdf5” file.</p>
</div>
<p><strong>Dataset Stats (2016)</strong></p>
<blockquote>
<div><ul>
<li><p>SNR Values: -20, -18, … 18 (20 values)</p></li>
<li><p>Classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="n">PSK</span>      <span class="mi">1</span><span class="p">:</span><span class="n">AM</span><span class="o">-</span><span class="n">DSB</span>    <span class="mi">2</span><span class="p">:</span><span class="n">BPSK</span>      <span class="mi">3</span><span class="p">:</span><span class="n">CPFSK</span>     <span class="mi">4</span><span class="p">:</span><span class="n">GFSK</span>
<span class="mi">5</span><span class="p">:</span><span class="n">PAM4</span>      <span class="mi">6</span><span class="p">:</span><span class="n">QAM16</span>     <span class="mi">7</span><span class="p">:</span><span class="n">QAM64</span>     <span class="mi">8</span><span class="p">:</span><span class="n">QPSK</span>      <span class="mi">9</span><span class="p">:</span><span class="n">WBFM</span>
</pre></div>
</div>
</li>
<li><p>Samples per SNR per class: 6,000</p></li>
<li><p>Samples per SNR value: 60,000</p></li>
<li><p>Samples per class: 120,000</p></li>
<li><p>Total Samples: 1,200,000 (= 10 * 20 * 6000)</p></li>
<li><p>The range of values in the dataset depends on the SNR values. The range is usually larger for larger SNR values; except for very small SNR values since they mostly contain noise. Here are the ranges for a few examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.030309</span> <span class="o">..</span> <span class="mf">0.032651</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.030112</span> <span class="o">..</span> <span class="mf">0.031982</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span>   <span class="o">-</span><span class="mf">0.061123</span> <span class="o">..</span> <span class="mf">0.066305</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span><span class="p">:</span>  <span class="o">-</span><span class="mf">0.129547</span> <span class="o">..</span> <span class="mf">0.106047</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">18</span><span class="p">:</span>  <span class="o">-</span><span class="mf">0.161878</span> <span class="o">..</span> <span class="mf">0.180627</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="n">All</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.210572</span> <span class="o">..</span> <span class="mf">0.180627</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p><strong>Dataset Stats (2018)</strong></p>
<blockquote>
<div><ul>
<li><p>SNR Values: -20, -18, … 28, 30 (26 values)</p></li>
<li><p>Classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">:</span><span class="mi">32</span><span class="n">PSK</span>         <span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="n">APSK</span>        <span class="mi">2</span><span class="p">:</span><span class="mi">32</span><span class="n">QAM</span>         <span class="mi">3</span><span class="p">:</span><span class="n">FM</span>
<span class="mi">4</span><span class="p">:</span><span class="n">GMSK</span>          <span class="mi">5</span><span class="p">:</span><span class="mi">32</span><span class="n">APSK</span>        <span class="mi">6</span><span class="p">:</span><span class="n">OQPSK</span>         <span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="n">ASK</span>
<span class="mi">8</span><span class="p">:</span><span class="n">BPSK</span>          <span class="mi">9</span><span class="p">:</span><span class="mi">8</span><span class="n">PSK</span>          <span class="mi">10</span><span class="p">:</span><span class="n">AM</span><span class="o">-</span><span class="n">SSB</span><span class="o">-</span><span class="n">SC</span>    <span class="mi">11</span><span class="p">:</span><span class="mi">4</span><span class="n">ASK</span>
<span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="n">PSK</span>        <span class="mi">13</span><span class="p">:</span><span class="mi">64</span><span class="n">APSK</span>       <span class="mi">14</span><span class="p">:</span><span class="mi">128</span><span class="n">QAM</span>       <span class="mi">15</span><span class="p">:</span><span class="mi">128</span><span class="n">APSK</span>
<span class="mi">16</span><span class="p">:</span><span class="n">AM</span><span class="o">-</span><span class="n">DSB</span><span class="o">-</span><span class="n">SC</span>    <span class="mi">17</span><span class="p">:</span><span class="n">AM</span><span class="o">-</span><span class="n">SSB</span><span class="o">-</span><span class="n">WC</span>    <span class="mi">18</span><span class="p">:</span><span class="mi">64</span><span class="n">QAM</span>        <span class="mi">19</span><span class="p">:</span><span class="n">QPSK</span>
<span class="mi">20</span><span class="p">:</span><span class="mi">256</span><span class="n">QAM</span>       <span class="mi">21</span><span class="p">:</span><span class="n">AM</span><span class="o">-</span><span class="n">DSB</span><span class="o">-</span><span class="n">WC</span>    <span class="mi">22</span><span class="p">:</span><span class="n">OOK</span>          <span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="n">QAM</span>
</pre></div>
</div>
</li>
<li><p>Samples per SNR per class: 4,096</p></li>
<li><p>Samples per SNR value: 98,304</p></li>
<li><p>Samples per class: 106,496</p></li>
<li><p>Total Samples: 2,555,904  (= 24 * 26 * 4096)</p></li>
<li><p>Max Absolute Value in the whole dataset: 68.32339</p></li>
<li><p>The range of values in the dataset depends on the SNR values. The range is usually larger for larger SNR values; except for very small SNR values since they mostly contain noise. Here are the ranges for a few examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.921285</span> <span class="o">..</span> <span class="mf">3.855273</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.941709</span> <span class="o">..</span> <span class="mf">4.169807</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span>   <span class="o">-</span><span class="mf">4.842472</span> <span class="o">..</span> <span class="mf">4.522851</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span><span class="p">:</span>  <span class="o">-</span><span class="mf">12.566387</span> <span class="o">..</span> <span class="mf">12.534958</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">20</span><span class="p">:</span>  <span class="o">-</span><span class="mf">49.853298</span> <span class="o">..</span> <span class="mf">50.442608</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">30</span><span class="p">:</span>  <span class="o">-</span><span class="mf">37.581909</span> <span class="o">..</span> <span class="mf">41.837891</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="n">All</span><span class="p">:</span> <span class="o">-</span><span class="mf">68.323387</span> <span class="o">..</span> <span class="mf">51.562645</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">fireball.datasets.radioml.</span></span><span class="sig-name descname"><span class="pre">RadioMlDSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrValues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2016</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOD'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the RadioML dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrValues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2016</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOD'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet" title="fireball.datasets.radioml.RadioMlDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadioMlDSet</span></code></a> instance. This can be called directly or via <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.makeDatasets" title="fireball.datasets.radioml.RadioMlDSet.makeDatasets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeDatasets()</span></code></a> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsName</strong> (<em>str</em>) – The name of the dataset. It can be one of “Train”, “Test”, or “Tune”. Note that “Valid” cannot be used here.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>samples</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is used as the samples for the dataset. It is a numpy array of samples. Each sample is numpy array of shape (128,1,2) for the 2016 version or (1024,1,2) for 2018 version.</p></li>
<li><p><strong>labels</strong> (<em>numpy array</em><em> or </em><em>None</em>) – If specified, it is a numpy array of int32 values. Each label is an int32 number indicating the class for each sample. (see the classNames above)</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The default batch size used in the “batches” method.</p></li>
<li><p><strong>snrValues</strong> (<em>int</em><em>, </em><em>list of ints</em><em>, or </em><em>None</em>) – <ul>
<li><p>If it is an int, it specifies the single SNR value that must be used. The dataset will contain the data for the specified SNR value only.</p></li>
<li><p>If it is a list of ints, only the samples for the specified SNR values are included in the dataset.</p></li>
<li><p>If it is None, all samples for all SNR values are included in the dataset.</p></li>
</ul>
</p></li>
<li><p><strong>version</strong> (<em>int</em>) – <p>The version of the RadioML dataset. It can be either 1016 (the default) or 2018. The actual dataset versions used are as follows:</p>
<blockquote>
<div><ul>
<li><p>2016: RADIOML 2016.10B</p></li>
<li><p>2018: RADIOML 2018.01A</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>labelMode</strong> (<em>str</em>) – <p>Specifies the type of label to be returned in batches of the data.</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">MOD</span></code>: This mode returns the modulation class as the label. (Default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNR</span></code>: This mode returns the SNR index as the label</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BOTH</span></code>: This mode returns a tuple of Modulation classes and SNR indexes as labels</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.download">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataFolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.download" title="Permalink to this definition"></a></dt>
<dd><p>This class method can be called to download the RadioML dataset files from a Fireball
online repository.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataFolder</strong> (<em>str</em>) – The folder where dataset files are saved. If this is not provided, then
a folder named “data” is created in the home directory of the current user and the
dataset folders and files are created there. In other words, the default data folder
is <code class="docutils literal notranslate"><span class="pre">~/data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.configure">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">configure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tuneRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2016</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.configure" title="Permalink to this definition"></a></dt>
<dd><p>Configures the <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet" title="fireball.datasets.radioml.RadioMlDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadioMlDSet</span></code></a> class. If a behavior other than the default is needed, this function can be called to prepare the class before instantiating the dataset instances.</p>
<p>Since the RadioML dataset doesn’t have a standard split for train, validation, and test samples, you can use this function to define the splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>testRatio</strong> (<em>float</em>) – The ratio between the number of test samples to the total samples in the dataset. The default is 0.5 which means 50% of the data is used for training and 50% for test.</p></li>
<li><p><strong>tuneRatio</strong> (<em>float</em>) – The ratio between the number of tuning samples to the number of training sample. The default is 0.1, which means 10% of the training samples are used for tuning dataset.</p></li>
<li><p><strong>validRatio</strong> (<em>float</em>) – The ratio between the number of validation samples to the number of training sample. The default is 0.1, which means 10% of the training samples are used for validation dataset. The remaining 90% are used as training samples. Please note that if “valid” is not specified when <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.makeDatasets" title="fireball.datasets.radioml.RadioMlDSet.makeDatasets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">makeDatasets()</span></code></a> is called, then all training samples are used for training.</p></li>
<li><p><strong>version</strong> (<em>int</em>) – <p>The version of the RadioML dataset. It can be either 1016 (the default) or 2018. The actual dataset versions used are as follows:</p>
<blockquote>
<div><ul>
<li><p>2016: RADIOML 2016.10B</p></li>
<li><p>2018: RADIOML 2018.01A</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>For example the following call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RadioMlDSet</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">testRatio</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">validRatio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>can be used to have 20% of the samples for test, 72% for training, and 8% for validation.</p>
<p>To Fine-Tune the trained model the following call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RadioMlDSet</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">testRatio</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">tuneRatio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">validRatio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>can be used to have 20% of samples for test, 7.2% for training (Fine-Tuning), and 0.8% for validation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.makeDatasets">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">makeDatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dsNames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Train,Test,Valid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrValues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2016</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOD'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.makeDatasets" title="Permalink to this definition"></a></dt>
<dd><p>This class method creates several datasets as specified by <cite>dsNames</cite> parameter in one-shot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsNames</strong> (<em>str</em>) – <p>A combination of the following:</p>
<ul>
<li><p><strong>”Train”</strong>: Create the training dataset.</p></li>
<li><p><strong>”Test”</strong>: Create the test dataset.</p></li>
<li><p><strong>”Valid”</strong>: Create the validation dataset. The ratio of validation samples can be specified using the <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.configure" title="fireball.datasets.radioml.RadioMlDSet.configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure()</span></code></a> method before calling to this function. The default is 10% of training data. If it is used with tuning data, the ratio specifies the portion of tune samples (not train samples).</p></li>
<li><p><strong>”Tune”</strong>: Create the Fine-Tuning datas. The ratio of fine-tuning samples can be specified using the <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.configure" title="fireball.datasets.radioml.RadioMlDSet.configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure()</span></code></a> method before calling to this function. The default is 10% of training data.</p></li>
</ul>
</p></li>
<li><p><strong>batchSize</strong> (<em>int</em>) – The batchSize used for all the datasets created.</p></li>
<li><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p></li>
<li><p><strong>snrValues</strong> (<em>int</em><em>, </em><em>list of ints</em><em>, or </em><em>None</em>) – Indicates which SNR values must be included in the dataset. Refer to the <cite>snrValues</cite> parameter of <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet.__init__" title="fireball.datasets.radioml.RadioMlDSet.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method for more info.</p></li>
<li><p><strong>version</strong> (<em>int</em>) – <p>The version of the RadioML dataset. It can be either 1016 (the default) or 2018. The actual datasets used are as follows:</p>
<blockquote>
<div><ul>
<li><p>2016: RADIOML 2016.10B</p></li>
<li><p>2018: RADIOML 2018.01A</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>labelMode</strong> (<em>str</em>) – <p>Specifies the type of label to be returned in batches of the data.</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">MOD</span></code>: This mode returns the modulation class as the label. (Default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SNR</span></code>: This mode returns the SNR index as the label</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BOTH</span></code>: This mode returns a tuple of Modulation classes and SNR indexes as labels</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the number of items specified in the <cite>dsNames</cite>, it returns between one and three <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet" title="fireball.datasets.radioml.RadioMlDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadioMlDSet</span></code></a> objects. The returned values have the same order as they appear in the <cite>dsNames</cite> parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Up to 3 <a class="reference internal" href="#fireball.datasets.radioml.RadioMlDSet" title="fireball.datasets.radioml.RadioMlDSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadioMlDSet</span></code></a> objects</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>To specify the training dataset, any string containing the word “train” (case insensitive) is accepted. So, “Training”, “TRAIN”, and ‘train’ all can be used.</p></li>
<li><p>To specify the test dataset, any string containing the word “test” (case insensitive) is accepted. So, “testing”, “TEST”, and ‘test’ all can be used.</p></li>
<li><p>To specify the validation dataset, any string containing the word “valid” (case insensitive) is accepted. So, “Validation”, “VALID”, and ‘valid’ all can be used.</p></li>
<li><p>To specify the fine-tuning dataset, any string containing the word “tun” (case insensitive) is accepted. So, “Fine-Tuning”, “Tuning”, and ‘tune’ all can be used.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.printDsInfo">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">printDsInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.printDsInfo" title="Permalink to this definition"></a></dt>
<dd><p>This class method prints information about given set of datasets in a single table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The training dataset.</p></li>
<li><p><strong>testDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The test dataset.</p></li>
<li><p><strong>validDs</strong> (any object derived from <cite>BaseDSet</cite>, optional) – The validation dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.getBatch">
<span class="sig-name descname"><span class="pre">getBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batchIndexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.getBatch" title="Permalink to this definition"></a></dt>
<dd><p>This method returns a batch of samples and labels from the dataset as specified by the list of indexes in the <cite>batchIndexes</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batchIndexes</strong> (<em>list of int</em>) – A list of indexes used to pick samples and labels from the dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>samples</strong> (<em>list or numpy array</em>) – The batch samples specified by the <cite>batchIndexes</cite>.</p></li>
<li><p><strong>labels</strong> (<em>list or numpy array</em>) – The batch labels specified by the <cite>batchIndexes</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fireball.datasets.radioml.RadioMlDSet.createNpzFiles">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">createNpzFiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fireball.datasets.radioml.RadioMlDSet.createNpzFiles" title="Permalink to this definition"></a></dt>
<dd><p>For the 2018 version of RadioML dataset, this function reads the dataset information from the original dataset file <code class="docutils literal notranslate"><span class="pre">GOLD_XYZ_OSC.0001_1024.hdf5</span></code> and creates an “npz” file for each SNR value.</p>
<p>This only needs to be done once before this dataset can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPath</strong> (<em>str</em>) – The path to the directory where the dataset files are located.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="model.html" class="btn btn-neutral float-left" title="Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, InterDigital, Inc. All Rights Reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>